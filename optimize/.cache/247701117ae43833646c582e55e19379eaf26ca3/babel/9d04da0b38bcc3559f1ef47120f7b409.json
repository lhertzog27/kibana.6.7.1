{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/src/ui/public/filter_manager/filter_manager.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/src/ui/public/filter_manager/filter_manager.js","mtime":1567631711733},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FilterManagerProvider = FilterManagerProvider;\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _query_filter = require('../filter_bar/query_filter');\n\nvar _esQuery = require('@kbn/es-query');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Adds a filter to a passed state\nfunction FilterManagerProvider(Private) {\n  var queryFilter = Private(_query_filter.FilterBarQueryFilterProvider);\n  var filterManager = {};\n\n  filterManager.generate = function (field, values, operation, index) {\n    values = Array.isArray(values) ? values : [values];\n    var fieldName = _lodash2.default.isObject(field) ? field.name : field;\n    var filters = _lodash2.default.flatten([queryFilter.getAppFilters()]);\n    var newFilters = [];\n\n    var negate = operation === '-';\n\n    // TODO: On array fields, negating does not negate the combination, rather all terms\n    _lodash2.default.each(values, function (value) {\n      var filter = void 0;\n      var existing = _lodash2.default.find(filters, function (filter) {\n        if (!filter) return;\n\n        if (fieldName === '_exists_' && filter.exists) {\n          return filter.exists.field === value;\n        }\n\n        if (_lodash2.default.has(filter, 'query.match')) {\n          return filter.query.match[fieldName] && filter.query.match[fieldName].query === value;\n        }\n\n        if (filter.script) {\n          return filter.meta.field === fieldName && filter.script.script.params.value === value;\n        }\n      });\n\n      if (existing) {\n        existing.meta.disabled = false;\n        if (existing.meta.negate !== negate) {\n          queryFilter.invertFilter(existing);\n        }\n        return;\n      }\n\n      switch (fieldName) {\n        case '_exists_':\n          filter = {\n            meta: { negate: negate, index: index },\n            exists: {\n              field: value\n            }\n          };\n          break;\n        default:\n          if (field.scripted) {\n            filter = {\n              meta: { negate: negate, index: index, field: fieldName },\n              script: (0, _esQuery.getPhraseScript)(field, value)\n            };\n          } else {\n            filter = { meta: { negate: negate, index: index }, query: { match: {} } };\n            filter.query.match[fieldName] = { query: value, type: 'phrase' };\n          }\n\n          break;\n      }\n\n      newFilters.push(filter);\n    });\n\n    return newFilters;\n  };\n\n  filterManager.add = function (field, values, operation, index) {\n    var newFilters = this.generate(field, values, operation, index);\n    return queryFilter.addFilters(newFilters);\n  };\n\n  return filterManager;\n} /*\n   * Licensed to Elasticsearch B.V. under one or more contributor\n   * license agreements. See the NOTICE file distributed with\n   * this work for additional information regarding copyright\n   * ownership. Elasticsearch B.V. licenses this file to you under\n   * the Apache License, Version 2.0 (the \"License\"); you may\n   * not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *    http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing,\n   * software distributed under the License is distributed on an\n   * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n   * KIND, either express or implied.  See the License for the\n   * specific language governing permissions and limitations\n   * under the License.\n   */",null]}