{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/src/ui/public/vis/editors/default/agg.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/src/ui/public/vis/editors/default/agg.js","mtime":1567631711770},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nrequire('./agg_params');\n\nrequire('./agg_add');\n\nvar _keyboard_move = require('./keyboard_move');\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _modules = require('../../../modules');\n\nvar _agg = require('./agg.html');\n\nvar _agg2 = _interopRequireDefault(_agg);\n\nvar _collection = require('../../../utils/collection');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_modules.uiModules.get('app/visualize').directive('visEditorAgg', function () {\n  return {\n    restrict: 'A',\n    template: _agg2.default,\n    require: 'form',\n    link: function link($scope, $el, attrs, kbnForm) {\n      $scope.editorOpen = !!$scope.agg.brandNew;\n\n      $scope.$watch('editorOpen', function (open) {\n        // make sure that all of the form inputs are \"touched\"\n        // so that their errors propagate\n        if (!open) kbnForm.$setTouched();\n      });\n\n      $scope.$watchMulti(['$index', 'group.length'], function () {\n        $scope.aggIsTooLow = calcAggIsTooLow();\n      });\n\n      /**\n      * Describe the aggregation, for display in the collapsed agg header\n      * @return {[type]} [description]\n      */\n      $scope.describe = function () {\n        if (!$scope.agg.type.makeLabel) return '';\n        var label = $scope.agg.type.makeLabel($scope.agg);\n        return label ? label : '';\n      };\n\n      $scope.$on('drag-start', function () {\n        $scope.editorWasOpen = $scope.editorOpen;\n        $scope.editorOpen = false;\n        $scope.$emit('agg-drag-start', $scope.agg);\n      });\n\n      $scope.$on('drag-end', function () {\n        $scope.editorOpen = $scope.editorWasOpen;\n        $scope.$emit('agg-drag-end', $scope.agg);\n      });\n\n      /**\n      * Move aggregations down/up in the priority list by pressing arrow keys.\n      */\n      $scope.onPriorityReorder = function (direction) {\n        var positionOffset = direction === _keyboard_move.Direction.down ? 1 : -1;\n\n        var currentPosition = $scope.group.indexOf($scope.agg);\n        var newPosition = Math.max(0, Math.min(currentPosition + positionOffset, $scope.group.length - 1));\n        (0, _collection.move)($scope.group, currentPosition, newPosition);\n        $scope.$emit('agg-reorder');\n      };\n\n      $scope.remove = function (agg) {\n        var aggs = $scope.state.aggs;\n        var index = aggs.indexOf(agg);\n\n        if (index === -1) {\n          return;\n        }\n\n        aggs.splice(index, 1);\n      };\n\n      $scope.canRemove = function (aggregation) {\n        var metricCount = _lodash2.default.reduce($scope.group, function (count, agg) {\n          return agg.schema.name === aggregation.schema.name ? ++count : count;\n        }, 0);\n\n        // make sure the the number of these aggs is above the min\n        return metricCount > aggregation.schema.min;\n      };\n\n      function calcAggIsTooLow() {\n        if (!$scope.agg.schema.mustBeFirst) {\n          return false;\n        }\n\n        var firstDifferentSchema = _lodash2.default.findIndex($scope.group, function (agg) {\n          return agg.schema !== $scope.agg.schema;\n        });\n\n        if (firstDifferentSchema === -1) {\n          return false;\n        }\n\n        return $scope.$index > firstDifferentSchema;\n      }\n    }\n  };\n}); /*\n     * Licensed to Elasticsearch B.V. under one or more contributor\n     * license agreements. See the NOTICE file distributed with\n     * this work for additional information regarding copyright\n     * ownership. Elasticsearch B.V. licenses this file to you under\n     * the Apache License, Version 2.0 (the \"License\"); you may\n     * not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *    http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing,\n     * software distributed under the License is distributed on an\n     * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n     * KIND, either express or implied.  See the License for the\n     * specific language governing permissions and limitations\n     * under the License.\n     */",null]}