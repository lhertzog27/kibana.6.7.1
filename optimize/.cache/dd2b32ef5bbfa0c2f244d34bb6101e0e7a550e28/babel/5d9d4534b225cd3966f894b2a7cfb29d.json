{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/rollup/public/crud_app/sections/job_list/job_table/job_table.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/rollup/public/crud_app/sections/job_list/job_table/job_table.js","mtime":1567631712290},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.JobTable = exports.JobTableUi = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _i18n = require('@kbn/i18n');\n\nvar _react3 = require('@kbn/i18n/react');\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _eui = require('@elastic/eui');\n\nvar _components = require('../../components');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * or more contributor license agreements. Licensed under the Elastic License;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the Elastic License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar COLUMNS = [{\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.nameHeader', {\n    defaultMessage: 'ID'\n  }),\n  fieldName: 'id'\n}, {\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.statusHeader', {\n    defaultMessage: 'Status'\n  }),\n  fieldName: 'status',\n  render: function render(_ref) {\n    var status = _ref.status,\n        rollupCron = _ref.rollupCron;\n\n    return _react2.default.createElement(\n      _eui.EuiToolTip,\n      { placement: 'top', content: 'Cron: ' + rollupCron },\n      _react2.default.createElement(_components.JobStatus, { status: status })\n    );\n  }\n}, {\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.indexPatternHeader', {\n    defaultMessage: 'Index pattern'\n  }),\n  truncateText: true,\n  fieldName: 'indexPattern'\n}, {\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.rollupIndexHeader', {\n    defaultMessage: 'Rollup index'\n  }),\n  truncateText: true,\n  fieldName: 'rollupIndex'\n}, {\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.delayHeader', {\n    defaultMessage: 'Delay'\n  }),\n  fieldName: 'rollupDelay',\n  render: function render(_ref2) {\n    var rollupDelay = _ref2.rollupDelay;\n    return rollupDelay || 'None';\n  }\n}, {\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.intervalHeader', {\n    defaultMessage: 'Interval'\n  }),\n  fieldName: 'dateHistogramInterval'\n}, {\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.groupsHeader', {\n    defaultMessage: 'Groups'\n  }),\n  truncateText: true,\n  render: function render(job) {\n    var histogram = job.histogram,\n        terms = job.terms;\n\n    var humanizedGroupNames = [];\n\n    if (histogram.length) {\n      humanizedGroupNames.push('histogram');\n    }\n\n    if (terms.length) {\n      humanizedGroupNames.push('terms');\n    }\n\n    if (humanizedGroupNames.length) {\n      humanizedGroupNames[0] = humanizedGroupNames[0].replace(/^\\w/, function (char) {\n        return char.toUpperCase();\n      });\n      return humanizedGroupNames.join(', ');\n    }\n\n    return '';\n  }\n}, {\n  name: _i18n.i18n.translate('xpack.rollupJobs.jobTable.headers.metricsHeader', {\n    defaultMessage: 'Metrics'\n  }),\n  truncateText: true,\n  render: function render(job) {\n    var metrics = job.metrics;\n\n\n    if (metrics.length) {\n      return metrics.map(function (metric) {\n        return metric.name;\n      }).join(', ');\n    }\n\n    return '';\n  }\n}];\n\nvar JobTableUi = exports.JobTableUi = function (_Component) {\n  _inherits(JobTableUi, _Component);\n\n  _createClass(JobTableUi, null, [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(props, state) {\n      // Deselct any jobs which no longer exist, e.g. they've been deleted.\n      var idToSelectedJobMap = state.idToSelectedJobMap;\n\n      var jobIds = props.jobs.map(function (job) {\n        return job.id;\n      });\n      var selectedJobIds = Object.keys(idToSelectedJobMap);\n      var missingJobIds = selectedJobIds.filter(function (selectedJobId) {\n        return !jobIds.includes(selectedJobId);\n      });\n\n      if (missingJobIds.length) {\n        var newMap = _extends({}, idToSelectedJobMap);\n        missingJobIds.forEach(function (missingJobId) {\n          return delete newMap[missingJobId];\n        });\n        return { idToSelectedJobMap: newMap };\n      }\n\n      return null;\n    }\n  }]);\n\n  function JobTableUi(props) {\n    _classCallCheck(this, JobTableUi);\n\n    var _this = _possibleConstructorReturn(this, (JobTableUi.__proto__ || Object.getPrototypeOf(JobTableUi)).call(this, props));\n\n    _this.toggleAll = function () {\n      var allSelected = _this.areAllItemsSelected();\n\n      if (allSelected) {\n        return _this.setState({ idToSelectedJobMap: {} });\n      }\n\n      var jobs = _this.props.jobs;\n\n      var idToSelectedJobMap = {};\n\n      jobs.forEach(function (_ref3) {\n        var id = _ref3.id;\n\n        idToSelectedJobMap[id] = true;\n      });\n\n      _this.setState({ idToSelectedJobMap: idToSelectedJobMap });\n    };\n\n    _this.toggleItem = function (id) {\n      _this.setState(function (_ref4) {\n        var idToSelectedJobMap = _ref4.idToSelectedJobMap;\n\n        var newMap = _extends({}, idToSelectedJobMap);\n\n        if (newMap[id]) {\n          delete newMap[id];\n        } else {\n          newMap[id] = true;\n        }\n\n        return { idToSelectedJobMap: newMap };\n      });\n    };\n\n    _this.resetSelection = function () {\n      _this.setState({ idToSelectedJobMap: {} });\n    };\n\n    _this.deselectItems = function (itemIds) {\n      _this.setState(function (_ref5) {\n        var idToSelectedJobMap = _ref5.idToSelectedJobMap;\n\n        var newMap = _extends({}, idToSelectedJobMap);\n        itemIds.forEach(function (id) {\n          return delete newMap[id];\n        });\n        return { idToSelectedJobMap: newMap };\n      });\n    };\n\n    _this.areAllItemsSelected = function () {\n      var jobs = _this.props.jobs;\n\n      var indexOfUnselectedItem = jobs.findIndex(function (job) {\n        return !_this.isItemSelected(job.id);\n      });\n      return indexOfUnselectedItem === -1;\n    };\n\n    _this.isItemSelected = function (id) {\n      return !!_this.state.idToSelectedJobMap[id];\n    };\n\n    _this.onSort = function (column) {\n      var _this$props = _this.props,\n          sortField = _this$props.sortField,\n          isSortAscending = _this$props.isSortAscending,\n          sortChanged = _this$props.sortChanged;\n\n\n      var newIsSortAscending = sortField === column ? !isSortAscending : true;\n      sortChanged(column, newIsSortAscending);\n    };\n\n    _this.state = {\n      idToSelectedJobMap: {}\n    };\n    return _this;\n  }\n\n  _createClass(JobTableUi, [{\n    key: 'getSelectedJobs',\n    value: function getSelectedJobs() {\n      var jobs = this.props.jobs;\n      var idToSelectedJobMap = this.state.idToSelectedJobMap;\n\n      return Object.keys(idToSelectedJobMap).map(function (jobId) {\n        return jobs.find(function (job) {\n          return job.id === jobId;\n        });\n      });\n    }\n  }, {\n    key: 'buildHeader',\n    value: function buildHeader() {\n      var _this2 = this;\n\n      var _props = this.props,\n          sortField = _props.sortField,\n          isSortAscending = _props.isSortAscending;\n\n      return COLUMNS.map(function (_ref6) {\n        var name = _ref6.name,\n            fieldName = _ref6.fieldName;\n\n        var isSorted = sortField === fieldName;\n\n        return _react2.default.createElement(\n          _eui.EuiTableHeaderCell,\n          {\n            key: name,\n            onSort: fieldName ? function () {\n              return _this2.onSort(fieldName);\n            } : undefined,\n            isSorted: isSorted,\n            isSortAscending: isSortAscending,\n            'data-test-subj': 'jobTableHeaderCell-' + name\n          },\n          name\n        );\n      });\n    }\n  }, {\n    key: 'buildRowCells',\n    value: function buildRowCells(job) {\n      var openDetailPanel = this.props.openDetailPanel;\n\n\n      return COLUMNS.map(function (_ref7) {\n        var name = _ref7.name,\n            fieldName = _ref7.fieldName,\n            render = _ref7.render,\n            truncateText = _ref7.truncateText;\n\n        var value = render ? render(job) : job[fieldName];\n        var content = void 0;\n\n        if (name === 'ID') {\n          content = _react2.default.createElement(\n            _eui.EuiLink,\n            {\n              onClick: function onClick() {\n                openDetailPanel(job.id);\n              }\n            },\n            value\n          );\n        } else {\n          content = _react2.default.createElement(\n            'span',\n            null,\n            value\n          );\n        }\n\n        var wrappedContent = void 0;\n\n        if (truncateText) {\n          wrappedContent = _react2.default.createElement(\n            _eui.EuiToolTip,\n            { content: value },\n            content\n          );\n        } else {\n          wrappedContent = content;\n        }\n\n        return _react2.default.createElement(\n          _eui.EuiTableRowCell,\n          {\n            key: job.id + '-' + name,\n            'data-test-subj': 'jobTableCell-' + _lodash2.default.camelCase(name),\n            truncateText: truncateText\n          },\n          wrappedContent\n        );\n      });\n    }\n  }, {\n    key: 'buildRows',\n    value: function buildRows() {\n      var _this3 = this;\n\n      var jobs = this.props.jobs;\n\n\n      return jobs.map(function (job) {\n        var id = job.id;\n\n\n        return _react2.default.createElement(\n          _eui.EuiTableRow,\n          {\n            key: id + '-row',\n            'data-test-subj': 'jobTableRow'\n          },\n          _react2.default.createElement(\n            _eui.EuiTableRowCellCheckbox,\n            { key: 'checkbox-' + id },\n            _react2.default.createElement(_eui.EuiCheckbox, {\n              type: 'inList',\n              id: 'checkboxSelectIndex-' + id,\n              checked: _this3.isItemSelected(id),\n              onChange: function onChange() {\n                _this3.toggleItem(id);\n              },\n              'data-test-subj': 'indexTableRowCheckbox'\n            })\n          ),\n          _this3.buildRowCells(job)\n        );\n      });\n    }\n  }, {\n    key: 'renderPager',\n    value: function renderPager() {\n      var _props2 = this.props,\n          pager = _props2.pager,\n          pageChanged = _props2.pageChanged,\n          pageSizeChanged = _props2.pageSizeChanged;\n\n      return _react2.default.createElement(_eui.EuiTablePagination, {\n        activePage: pager.getCurrentPageIndex(),\n        itemsPerPage: pager.itemsPerPage,\n        itemsPerPageOptions: [20, 50, 100],\n        pageCount: pager.getTotalPages(),\n        onChangeItemsPerPage: pageSizeChanged,\n        onChangePage: pageChanged\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props3 = this.props,\n          filterChanged = _props3.filterChanged,\n          filter = _props3.filter,\n          jobs = _props3.jobs,\n          intl = _props3.intl,\n          closeDetailPanel = _props3.closeDetailPanel;\n      var idToSelectedJobMap = this.state.idToSelectedJobMap;\n\n\n      var atLeastOneItemSelected = Object.keys(idToSelectedJobMap).length > 0;\n\n      return _react2.default.createElement(\n        _react.Fragment,\n        null,\n        _react2.default.createElement(\n          _eui.EuiFlexGroup,\n          { gutterSize: 'l', alignItems: 'center' },\n          atLeastOneItemSelected ? _react2.default.createElement(\n            _eui.EuiFlexItem,\n            { grow: false },\n            _react2.default.createElement(_components.JobActionMenu, {\n              jobs: this.getSelectedJobs(),\n              closeDetailPanel: closeDetailPanel,\n              resetSelection: this.resetSelection,\n              deselectJobs: this.deselectItems\n            })\n          ) : null,\n          _react2.default.createElement(\n            _eui.EuiFlexItem,\n            null,\n            _react2.default.createElement(_eui.EuiFieldSearch, {\n              fullWidth: true,\n              value: filter,\n              onChange: function onChange(event) {\n                filterChanged(event.target.value);\n              },\n              'data-test-subj': 'jobTableFilterInput',\n              placeholder: intl.formatMessage({\n                id: 'xpack.rollupJobs.jobTable.searchInputPlaceholder',\n                defaultMessage: 'Search'\n              }),\n              'aria-label': 'Search jobs'\n            })\n          )\n        ),\n        _react2.default.createElement(_eui.EuiSpacer, { size: 'm' }),\n        jobs.length > 0 ? _react2.default.createElement(\n          _eui.EuiTable,\n          null,\n          _react2.default.createElement(\n            _eui.EuiTableHeader,\n            null,\n            _react2.default.createElement(\n              _eui.EuiTableHeaderCellCheckbox,\n              null,\n              _react2.default.createElement(_eui.EuiCheckbox, {\n                id: 'selectAllJobsCheckbox',\n                checked: this.areAllItemsSelected(),\n                onChange: this.toggleAll,\n                type: 'inList'\n              })\n            ),\n            this.buildHeader()\n          ),\n          _react2.default.createElement(\n            _eui.EuiTableBody,\n            null,\n            this.buildRows()\n          )\n        ) : _react2.default.createElement(\n          _eui.EuiText,\n          null,\n          _react2.default.createElement(\n            'p',\n            null,\n            _react2.default.createElement(_react3.FormattedMessage, {\n              id: 'xpack.rollupJobs.jobTable.noJobsMatchSearchMessage',\n              defaultMessage: 'No rollup jobs match your search'\n            })\n          )\n        ),\n        _react2.default.createElement(_eui.EuiSpacer, { size: 'm' }),\n        jobs.length > 0 ? this.renderPager() : null\n      );\n    }\n  }]);\n\n  return JobTableUi;\n}(_react.Component);\n\nJobTableUi.propTypes = {\n  jobs: _propTypes2.default.array,\n  pager: _propTypes2.default.object.isRequired,\n  filter: _propTypes2.default.string.isRequired,\n  sortField: _propTypes2.default.string.isRequired,\n  isSortAscending: _propTypes2.default.bool.isRequired,\n  closeDetailPanel: _propTypes2.default.func.isRequired,\n  filterChanged: _propTypes2.default.func.isRequired,\n  pageChanged: _propTypes2.default.func.isRequired,\n  pageSizeChanged: _propTypes2.default.func.isRequired,\n  sortChanged: _propTypes2.default.func.isRequired\n};\nJobTableUi.defaultProps = {\n  jobs: []\n};\nvar JobTable = exports.JobTable = (0, _react3.injectI18n)(JobTableUi);",null]}