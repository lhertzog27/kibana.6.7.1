{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/watcher/public/sections/watch_list/components/watch_list/watch_list.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/watcher/public/sections/watch_list/components/watch_list/watch_list.js","mtime":1567631712350},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _modules = require('ui/modules');\n\nvar _compat = require('ui/compat');\n\nvar _notify = require('ui/notify');\n\nvar _watch_list = require('./watch_list.html');\n\nvar _watch_list2 = _interopRequireDefault(_watch_list);\n\nrequire('../watch_table');\n\nvar _constants = require('plugins/watcher/../common/constants');\n\nrequire('ui/pager_control');\n\nrequire('ui/pager');\n\nrequire('ui/react_components');\n\nrequire('ui/table_info');\n\nrequire('plugins/watcher/components/tool_bar_selected_count');\n\nrequire('plugins/watcher/components/forbidden_message');\n\nrequire('plugins/watcher/services/watches');\n\nrequire('plugins/watcher/services/license');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * or more contributor license agreements. Licensed under the Elastic License;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the Elastic License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar app = _modules.uiModules.get('xpack/watcher');\n\napp.directive('watchList', function ($injector, i18n) {\n  var pagerFactory = $injector.get('pagerFactory');\n  var watchesService = $injector.get('xpackWatcherWatchesService');\n  var licenseService = $injector.get('xpackWatcherLicenseService');\n  var confirmModal = $injector.get('confirmModal');\n  var $interval = $injector.get('$interval');\n  var kbnUrl = $injector.get('kbnUrl');\n\n  var $filter = $injector.get('$filter');\n  var filter = $filter('filter');\n  var orderBy = $filter('orderBy');\n  var limitTo = $filter('limitTo');\n\n  return {\n    restrict: 'E',\n    template: _watch_list2.default,\n    scope: {\n      watches: '='\n    },\n    bindToController: true,\n    controllerAs: 'watchList',\n    controller: function (_InitAfterBindingsWor) {\n      _inherits(WatchListController, _InitAfterBindingsWor);\n\n      function WatchListController() {\n        var _ref;\n\n        var _temp, _this, _ret;\n\n        _classCallCheck(this, WatchListController);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = WatchListController.__proto__ || Object.getPrototypeOf(WatchListController)).call.apply(_ref, [this].concat(args))), _this), _this.loadWatches = function () {\n          watchesService.getWatchList().then(function (watches) {\n            _this.watches = watches;\n            _this.forbidden = false;\n          }).catch(function (err) {\n            return licenseService.checkValidity().then(function () {\n              if (err.status === 403) {\n                _this.forbidden = true;\n              } else {\n                _notify.toastNotifications.addDanger(err.data.message);\n              }\n            });\n          });\n        }, _this.onQueryChange = function (query) {\n          _this.query = query;\n        }, _this.onPageNext = function () {\n          _this.pager.nextPage();\n        }, _this.onPagePrevious = function () {\n          _this.pager.previousPage();\n        }, _this.onSortChange = function (field, reverse) {\n          _this.sortField = field;\n          _this.sortReverse = reverse;\n        }, _this.onSelectedChange = function (selectedWatches) {\n          _this.selectedWatches = selectedWatches;\n        }, _this.onClickCreateThresholdAlert = function () {\n          _this.goToWatchWizardForType(_constants.WATCH_TYPES.THRESHOLD);\n        }, _this.onClickCreateAdvancedWatch = function () {\n          _this.goToWatchWizardForType(_constants.WATCH_TYPES.JSON);\n        }, _this.goToWatchWizardForType = function (watchType) {\n          var url = 'management/elasticsearch/watcher/watches/new-watch/' + watchType;\n          kbnUrl.change(url, {});\n        }, _this.onSelectedWatchesDelete = function () {\n          var watchesBeingDeleted = _this.selectedWatches;\n          var numWatchesToDelete = watchesBeingDeleted.length;\n\n          var confirmModalText = i18n('xpack.watcher.sections.watchList.deleteSelectedWatchesConfirmModal.descriptionText', {\n            defaultMessage: 'This will permanently delete {numWatchesToDelete, plural, one {# Watch} other {# Watches}}. Are you sure?',\n            values: { numWatchesToDelete: numWatchesToDelete }\n          });\n          var confirmButtonText = i18n('xpack.watcher.sections.watchList.deleteSelectedWatchesConfirmModal.deleteButtonLabel', {\n            defaultMessage: 'Delete {numWatchesToDelete, plural, one {# Watch} other {# Watches}} ',\n            values: { numWatchesToDelete: numWatchesToDelete }\n          });\n\n          var confirmModalOptions = {\n            confirmButtonText: confirmButtonText,\n            onConfirm: function onConfirm() {\n              return _this.deleteSelectedWatches(watchesBeingDeleted);\n            }\n          };\n\n          return confirmModal(confirmModalText, confirmModalOptions);\n        }, _this.deleteSelectedWatches = function (watchesBeingDeleted) {\n          _this.watchesBeingDeleted = watchesBeingDeleted;\n\n          var numWatchesToDelete = _this.watchesBeingDeleted.length;\n\n          var watchIds = _this.watchesBeingDeleted.map(function (watch) {\n            return watch.id;\n          });\n          return watchesService.deleteWatches(watchIds).then(function (results) {\n            var numSuccesses = results.numSuccesses;\n            var numErrors = results.numErrors;\n            var numTotal = numWatchesToDelete;\n\n            if (numSuccesses > 0) {\n              _notify.toastNotifications.addSuccess(i18n('xpack.watcher.sections.watchList.deleteSelectedWatchesSuccessNotification.descriptionText', {\n                defaultMessage: 'Deleted {numSuccesses} out of {numTotal} selected {numWatchesToDelete, plural, one {# watch} other {# watches}}',\n                values: { numSuccesses: numSuccesses, numTotal: numTotal, numWatchesToDelete: numWatchesToDelete }\n              }));\n            }\n\n            if (numErrors > 0) {\n              _notify.toastNotifications.addError(i18n('xpack.watcher.sections.watchList.deleteSelectedWatchesErrorNotification.descriptionText', {\n                defaultMessage: 'Couldn\\'t delete {numErrors} out of {numTotal} selected {numWatchesToDelete, plural, one {# watch} other {# watches}}',\n                values: { numErrors: numErrors, numTotal: numTotal, numWatchesToDelete: numWatchesToDelete }\n              }));\n            }\n\n            _this.loadWatches();\n          }).catch(function (err) {\n            return licenseService.checkValidity().then(function () {\n              return _notify.toastNotifications.addDanger(err.data.message);\n            });\n          });\n        }, _this.applyFilters = function () {\n          var filteredWatches = _this.watches;\n          var pageOfWatches = [];\n\n          filteredWatches = filter(filteredWatches, { searchValue: _this.query });\n          filteredWatches = orderBy(filteredWatches, _this.sortField, _this.sortReverse);\n          pageOfWatches = limitTo(filteredWatches, _this.pager.pageSize, _this.pager.startIndex);\n\n          _this.pageOfWatches = pageOfWatches;\n          _this.pager.setTotalItems(filteredWatches.length);\n        }, _temp), _possibleConstructorReturn(_this, _ret);\n      }\n\n      _createClass(WatchListController, [{\n        key: 'initAfterBindings',\n        value: function initAfterBindings($scope) {\n          var _this2 = this;\n\n          this.forbidden = false;\n\n          //The initial load from watch_list_route will return null on a 403 error\n          if (this.watches === null) {\n            this.watches = [];\n            this.forbidden = true;\n          }\n\n          this.selectedWatches = [];\n          this.pageOfWatches = [];\n          this.sortField = 'id';\n          this.sortReverse = false;\n\n          this.pager = pagerFactory.create(this.watches.length, _constants.PAGINATION.PAGE_SIZE, 1);\n\n          // Reload watches periodically\n          var refreshInterval = $interval(function () {\n            return _this2.loadWatches();\n          }, _constants.REFRESH_INTERVALS.WATCH_LIST);\n          $scope.$on('$destroy', function () {\n            return $interval.cancel(refreshInterval);\n          });\n\n          // react to watch and ui changes\n          $scope.$watchMulti(['watchList.watches', 'watchList.sortField', 'watchList.sortReverse', 'watchList.query', 'watchList.pager.currentPage'], this.applyFilters);\n        }\n      }, {\n        key: 'hasPageOfWatches',\n        get: function get() {\n          return this.pageOfWatches.length > 0;\n        }\n      }, {\n        key: 'hasSelectedWatches',\n        get: function get() {\n          return this.selectedWatches.length > 0;\n        }\n      }]);\n\n      return WatchListController;\n    }(_compat.InitAfterBindingsWorkaround)\n  };\n});",null]}