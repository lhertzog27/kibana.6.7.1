{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/ml/public/components/validate_job/validate_job_view.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/ml/public/components/validate_job/validate_job_view.js","mtime":1567631712037},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ValidateJob = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _eui = require('@elastic/eui');\n\nvar _react3 = require('@kbn/i18n/react');\n\nvar _metadata = require('ui/metadata');\n\nvar _validation = require('../../../common/constants/validation');\n\nvar _validation_utils = require('../../../common/util/validation_utils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * or more contributor license agreements. Licensed under the Elastic License;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the Elastic License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// metadata.branch corresponds to the version used in documentation links.\nvar jobTipsUrl = 'https://www.elastic.co/guide/en/kibana/' + _metadata.metadata.branch + '/job-tips.html';\n\n// don't use something like plugins/ml/../common\n// because it won't work with the jest tests\n\n\nvar defaultIconType = 'questionInCircle';\nvar getDefaultState = function getDefaultState() {\n  return {\n    ui: {\n      iconType: defaultIconType,\n      isLoading: false,\n      isModalVisible: false\n    },\n    data: {\n      messages: [],\n      success: false\n    },\n    title: ''\n  };\n};\n\nvar statusToEuiColor = function statusToEuiColor(status) {\n  switch (status) {\n    case _validation.VALIDATION_STATUS.INFO:\n      return 'primary';\n      break;\n    case _validation.VALIDATION_STATUS.ERROR:\n      return 'danger';\n      break;\n    default:\n      return status;\n  }\n};\n\nvar statusToEuiIconType = function statusToEuiIconType(status) {\n  switch (status) {\n    case _validation.VALIDATION_STATUS.INFO:\n      return 'iInCircle';\n      break;\n    case _validation.VALIDATION_STATUS.ERROR:\n      return 'cross';\n      break;\n    case _validation.VALIDATION_STATUS.SUCCESS:\n      return 'check';\n      break;\n    case _validation.VALIDATION_STATUS.WARNING:\n      return 'alert';\n      break;\n    default:\n      return status;\n  }\n};\n\nvar Link = function Link(_ref) {\n  var url = _ref.url;\n  return _react2.default.createElement(\n    _eui.EuiLink,\n    { href: url, target: '_BLANK' },\n    _react2.default.createElement(_react3.FormattedMessage, {\n      id: 'xpack.ml.validateJob.learnMoreLinkText',\n      defaultMessage: 'Learn more'\n    })\n  );\n};\nLink.propTypes = {\n  url: _propTypes2.default.string.isRequired\n};\n\n// Message is its own component so it can be passed\n// as the \"title\" prop in the Callout component.\nvar Message = function Message(_ref2) {\n  var message = _ref2.message;\n  return _react2.default.createElement(\n    _react2.default.Fragment,\n    null,\n    message.text,\n    ' ',\n    message.url && _react2.default.createElement(Link, { url: message.url })\n  );\n};\nMessage.propTypes = {\n  message: _propTypes2.default.shape({\n    text: _propTypes2.default.string,\n    url: _propTypes2.default.string\n  })\n};\n\nvar Callout = function Callout(_ref3) {\n  var message = _ref3.message;\n  return _react2.default.createElement(\n    _react2.default.Fragment,\n    null,\n    _react2.default.createElement(\n      _eui.EuiCallOut,\n      {\n        color: statusToEuiColor(message.status),\n        size: 's',\n        title: message.heading || _react2.default.createElement(Message, { message: message }),\n        iconType: statusToEuiIconType(message.status)\n      },\n      message.heading && _react2.default.createElement(Message, { message: message })\n    ),\n    _react2.default.createElement(_eui.EuiSpacer, { size: 'm' })\n  );\n};\nCallout.propTypes = {\n  message: _propTypes2.default.shape({\n    status: _propTypes2.default.string,\n    text: _propTypes2.default.string,\n    url: _propTypes2.default.string\n  })\n};\n\nvar Modal = function Modal(_ref4) {\n  var close = _ref4.close,\n      title = _ref4.title,\n      children = _ref4.children;\n  return _react2.default.createElement(\n    _eui.EuiOverlayMask,\n    null,\n    _react2.default.createElement(\n      _eui.EuiModal,\n      {\n        onClose: close,\n        style: { width: '800px' }\n      },\n      _react2.default.createElement(\n        _eui.EuiModalHeader,\n        null,\n        _react2.default.createElement(\n          _eui.EuiModalHeaderTitle,\n          null,\n          title\n        )\n      ),\n      _react2.default.createElement(\n        _eui.EuiModalBody,\n        null,\n        children\n      ),\n      _react2.default.createElement(\n        _eui.EuiModalFooter,\n        null,\n        _react2.default.createElement(\n          _eui.EuiButton,\n          {\n            onClick: close,\n            size: 's',\n            fill: true\n          },\n          _react2.default.createElement(_react3.FormattedMessage, {\n            id: 'xpack.ml.validateJob.modal.closeButtonLabel',\n            defaultMessage: 'Close'\n          })\n        )\n      )\n    )\n  );\n};\nModal.propType = {\n  close: _propTypes2.default.func.isRequired,\n  title: _propTypes2.default.string\n};\n\nvar ValidateJob = function (_Component) {\n  _inherits(ValidateJob, _Component);\n\n  function ValidateJob(props) {\n    _classCallCheck(this, ValidateJob);\n\n    var _this = _possibleConstructorReturn(this, (ValidateJob.__proto__ || Object.getPrototypeOf(ValidateJob)).call(this, props));\n\n    _this.closeModal = function () {\n      var newState = getDefaultState();\n      newState.ui.iconType = _this.state.ui.iconType;\n      _this.setState(newState);\n    };\n\n    _this.openModal = function () {\n      var job = _this.props.getJobConfig();\n      var getDuration = _this.props.getDuration;\n      var duration = typeof getDuration === 'function' ? getDuration() : undefined;\n      var fields = _this.props.fields;\n\n      if ((typeof job === 'undefined' ? 'undefined' : _typeof(job)) === 'object') {\n        var shouldShowLoadingIndicator = true;\n\n        _this.props.mlJobService.validateJob({ duration: duration, fields: fields, job: job }).then(function (data) {\n          shouldShowLoadingIndicator = false;\n          _this.setState(_extends({}, _this.state, {\n            ui: _extends({}, _this.state.ui, {\n              iconType: statusToEuiIconType((0, _validation_utils.getMostSevereMessageStatus)(data.messages)),\n              isLoading: false,\n              isModalVisible: true\n            }),\n            data: data,\n            title: job.job_id\n          }));\n        });\n\n        // wait for 250ms before triggering the loading indicator\n        // to avoid flickering when there's a loading time below\n        // 250ms for the job validation data\n        var delay = 250;\n        setTimeout(function () {\n          if (shouldShowLoadingIndicator) {\n            _this.setState(_extends({}, _this.state, {\n              ui: _extends({}, _this.state.ui, {\n                isLoading: true,\n                isModalVisible: false\n              })\n            }));\n          }\n        }, delay);\n      }\n    };\n\n    _this.state = getDefaultState();\n    return _this;\n  }\n\n  _createClass(ValidateJob, [{\n    key: 'render',\n    value: function render() {\n      // only set to false if really false and not another falsy value, so it defaults to true.\n      var fill = this.props.fill === false ? false : true;\n      // default to false if not explicitly set to true\n      var isCurrentJobConfig = this.props.isCurrentJobConfig !== true ? false : true;\n      var isDisabled = this.props.isDisabled !== true ? false : true;\n\n      return _react2.default.createElement(\n        'div',\n        null,\n        _react2.default.createElement(\n          _eui.EuiButton,\n          {\n            onClick: this.openModal,\n            size: 's',\n            fill: fill,\n            iconType: isCurrentJobConfig ? this.state.ui.iconType : defaultIconType,\n            iconSide: 'right',\n            isDisabled: isDisabled,\n            isLoading: this.state.ui.isLoading\n          },\n          _react2.default.createElement(_react3.FormattedMessage, {\n            id: 'xpack.ml.validateJob.validateJobButtonLabel',\n            defaultMessage: 'Validate Job'\n          })\n        ),\n        !isDisabled && this.state.ui.isModalVisible && _react2.default.createElement(\n          Modal,\n          {\n            close: this.closeModal,\n            title: _react2.default.createElement(_react3.FormattedMessage, {\n              id: 'xpack.ml.validateJob.modal.validateJobTitle',\n              defaultMessage: 'Validate job {title}',\n              values: { title: this.state.title }\n            })\n          },\n          this.state.data.messages.map(function (m, i) {\n            return _react2.default.createElement(Callout, { key: m.id + '_' + i, message: m });\n          }),\n          _react2.default.createElement(\n            _eui.EuiText,\n            null,\n            _react2.default.createElement(_react3.FormattedMessage, {\n              id: 'xpack.ml.validateJob.modal.jobValidationDescriptionText',\n              defaultMessage: 'Job validation performs certain checks against job configurations and underlying source data and provides specific advice on how to adjust settings that are more likely to produce insightful results.'\n            })\n          ),\n          _react2.default.createElement(\n            _eui.EuiText,\n            null,\n            _react2.default.createElement(_react3.FormattedMessage, {\n              id: 'xpack.ml.validateJob.modal.linkToJobTipsText',\n              defaultMessage: 'For more information, see {mlJobTipsLink}.',\n              values: {\n                mlJobTipsLink: _react2.default.createElement(\n                  _eui.EuiLink,\n                  { href: jobTipsUrl, target: '_blank' },\n                  _react2.default.createElement(_react3.FormattedMessage, {\n                    id: 'xpack.ml.validateJob.modal.linkToJobTipsText.mlJobTipsLinkText',\n                    defaultMessage: 'Machine Learning Job Tips'\n                  })\n                )\n              }\n            })\n          )\n        )\n      );\n    }\n  }]);\n\n  return ValidateJob;\n}(_react.Component);\n\nValidateJob.propTypes = {\n  fields: _propTypes2.default.object,\n  fill: _propTypes2.default.bool,\n  getDuration: _propTypes2.default.func,\n  getJobConfig: _propTypes2.default.func.isRequired,\n  isCurrentJobConfig: _propTypes2.default.bool,\n  isDisabled: _propTypes2.default.bool,\n  mlJobService: _propTypes2.default.object.isRequired\n};\n\nexports.ValidateJob = ValidateJob;",null]}