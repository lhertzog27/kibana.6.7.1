{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/src/ui/public/field_editor/lib/validate_script.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/src/ui/public/field_editor/lib/validate_script.js","mtime":1567631711728},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isScriptValid = exports.executeScript = undefined;\n\nvar _kfetch = require('ui/kfetch');\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Licensed to Elasticsearch B.V. under one or more contributor\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * license agreements. See the NOTICE file distributed with\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * this work for additional information regarding copyright\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * ownership. Elasticsearch B.V. licenses this file to you under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * the Apache License, Version 2.0 (the \"License\"); you may\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * not use this file except in compliance with the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *    http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            */\n\nvar executeScript = exports.executeScript = function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(_ref) {\n    var name = _ref.name,\n        lang = _ref.lang,\n        script = _ref.script,\n        indexPatternTitle = _ref.indexPatternTitle,\n        _ref$additionalFields = _ref.additionalFields,\n        additionalFields = _ref$additionalFields === undefined ? [] : _ref$additionalFields;\n    var header, search, body, esResp;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            // Using _msearch because _search with index name in path dorks everything up\n            header = {\n              index: indexPatternTitle,\n              ignore_unavailable: true\n            };\n            search = {\n              query: {\n                match_all: {}\n              },\n              script_fields: _defineProperty({}, name, {\n                script: {\n                  lang: lang,\n                  source: script\n                }\n              }),\n              size: 10,\n              timeout: '30s'\n            };\n\n\n            if (additionalFields.length > 0) {\n              search._source = additionalFields;\n            }\n\n            body = JSON.stringify(header) + '\\n' + JSON.stringify(search) + '\\n';\n            _context.next = 6;\n            return (0, _kfetch.kfetch)({ method: 'POST', pathname: '/elasticsearch/_msearch', body: body });\n\n          case 6:\n            esResp = _context.sent;\n            return _context.abrupt('return', esResp.responses[0]);\n\n          case 8:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function executeScript(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar isScriptValid = exports.isScriptValid = function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(_ref3) {\n    var name = _ref3.name,\n        lang = _ref3.lang,\n        script = _ref3.script,\n        indexPatternTitle = _ref3.indexPatternTitle;\n    var scriptResponse;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return executeScript({ name: name, lang: lang, script: script, indexPatternTitle: indexPatternTitle });\n\n          case 2:\n            scriptResponse = _context2.sent;\n\n            if (!(scriptResponse.status !== 200)) {\n              _context2.next = 5;\n              break;\n            }\n\n            return _context2.abrupt('return', false);\n\n          case 5:\n            return _context2.abrupt('return', true);\n\n          case 6:\n          case 'end':\n            return _context2.stop();\n        }\n      }\n    }, _callee2, undefined);\n  }));\n\n  return function isScriptValid(_x2) {\n    return _ref4.apply(this, arguments);\n  };\n}();",null]}