{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/ml/public/jobs/jobs_list/components/edit_job_flyout/edit_job_flyout.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/ml/public/jobs/jobs_list/components/edit_job_flyout/edit_job_flyout.js","mtime":1567631712048},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EditJobFlyout = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _eui = require('@elastic/eui');\n\nvar _tabs = require('./tabs');\n\nvar _edit_utils = require('./edit_utils');\n\nvar _utils = require('../utils');\n\nvar _validate_job = require('../validate_job');\n\nvar _messagebar_service = require('../../../../components/messagebar/messagebar_service');\n\nvar _notify = require('ui/notify');\n\nvar _react3 = require('@kbn/i18n/react');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * or more contributor license agreements. Licensed under the Elastic License;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the Elastic License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar EditJobFlyoutUI = function (_Component) {\n  _inherits(EditJobFlyoutUI, _Component);\n\n  function EditJobFlyoutUI(props) {\n    _classCallCheck(this, EditJobFlyoutUI);\n\n    var _this = _possibleConstructorReturn(this, (EditJobFlyoutUI.__proto__ || Object.getPrototypeOf(EditJobFlyoutUI)).call(this, props));\n\n    _this.closeFlyout = function () {\n      _this.setState({ isFlyoutVisible: false });\n    };\n\n    _this.showFlyout = function (jobLite) {\n      var hasDatafeed = jobLite.hasDatafeed;\n      (0, _utils.loadFullJob)(jobLite.id).then(function (job) {\n        _this.extractJob(job, hasDatafeed);\n        _this.setState({\n          job: job,\n          isFlyoutVisible: true\n        });\n      }).catch(function (error) {\n        console.error(error);\n      });\n    };\n\n    _this.setJobDetails = function (jobDetails) {\n      var _this$state = _this.state,\n          jobModelMemoryLimitValidationError = _this$state.jobModelMemoryLimitValidationError,\n          jobGroupsValidationError = _this$state.jobGroupsValidationError;\n\n\n      if (jobDetails.jobModelMemoryLimit !== undefined) {\n        jobModelMemoryLimitValidationError = (0, _validate_job.validateModelMemoryLimit)(jobDetails.jobModelMemoryLimit).message;\n      }\n\n      if (jobDetails.jobGroups !== undefined) {\n        if (jobDetails.jobGroups.some(function (j) {\n          return _this.props.allJobIds.includes(j);\n        })) {\n          jobGroupsValidationError = _this.props.intl.formatMessage({\n            id: 'xpack.ml.jobsList.editJobFlyout.groupsAndJobsHasSameIdErrorMessage',\n            defaultMessage: 'A job with this ID already exists. Groups and jobs cannot use the same ID.'\n          });\n        } else {\n          jobGroupsValidationError = (0, _validate_job.validateGroupNames)(jobDetails.jobGroups).message;\n        }\n      }\n\n      var isValidJobDetails = jobModelMemoryLimitValidationError === '' && jobGroupsValidationError === '';\n\n      _this.setState(_extends({}, jobDetails, {\n        jobModelMemoryLimitValidationError: jobModelMemoryLimitValidationError,\n        jobGroupsValidationError: jobGroupsValidationError,\n        isValidJobDetails: isValidJobDetails\n      }));\n    };\n\n    _this.setDetectorDescriptions = function (jobDetectorDescriptions) {\n      _this.setState(_extends({}, jobDetectorDescriptions));\n    };\n\n    _this.setDatafeed = function (datafeed) {\n      _this.setState(_extends({}, datafeed));\n    };\n\n    _this.setCustomUrls = function (jobCustomUrls) {\n      var isValidJobCustomUrls = (0, _validate_job.isValidCustomUrls)(jobCustomUrls);\n      _this.setState({\n        jobCustomUrls: jobCustomUrls,\n        isValidJobCustomUrls: isValidJobCustomUrls\n      });\n    };\n\n    _this.save = function () {\n      var newJobData = {\n        description: _this.state.jobDescription,\n        groups: _this.state.jobGroups,\n        mml: _this.state.jobModelMemoryLimit,\n        detectorDescriptions: _this.state.jobDetectorDescriptions,\n        datafeedQuery: _this.state.datafeedQuery,\n        datafeedQueryDelay: _this.state.datafeedQueryDelay,\n        datafeedFrequency: _this.state.datafeedFrequency,\n        datafeedScrollSize: _this.state.datafeedScrollSize,\n        customUrls: _this.state.jobCustomUrls\n      };\n\n      (0, _edit_utils.saveJob)(_this.state.job, newJobData).then(function () {\n        _notify.toastNotifications.addSuccess(_this.props.intl.formatMessage({\n          id: 'xpack.ml.jobsList.editJobFlyout.changesSavedNotificationMessage',\n          defaultMessage: 'Changes to {jobId} saved' }, {\n          jobId: _this.state.job.job_id }));\n        _this.refreshJobs();\n        _this.closeFlyout();\n      }).catch(function (error) {\n        console.error(error);\n        _notify.toastNotifications.addDanger(_this.props.intl.formatMessage({\n          id: 'xpack.ml.jobsList.editJobFlyout.changesNotSavedNotificationMessage',\n          defaultMessage: 'Could not save changes to {jobId}' }, {\n          jobId: _this.state.job.job_id }));\n        _messagebar_service.mlMessageBarService.notify.error(error);\n      });\n    };\n\n    _this.state = {\n      job: {},\n      hasDatafeed: false,\n      isFlyoutVisible: false,\n      jobDescription: '',\n      jobGroups: [],\n      jobModelMemoryLimit: '',\n      jobDetectors: [],\n      jobDetectorDescriptions: [],\n      jobCustomUrls: [],\n      datafeedQuery: '',\n      datafeedQueryDelay: '',\n      datafeedFrequency: '',\n      datafeedScrollSize: '',\n      jobModelMemoryLimitValidationError: '',\n      jobGroupsValidationError: '',\n      isValidJobDetails: true,\n      isValidJobCustomUrls: true\n    };\n\n    _this.refreshJobs = _this.props.refreshJobs;\n    return _this;\n  }\n\n  _createClass(EditJobFlyoutUI, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (typeof this.props.setShowFunction === 'function') {\n        this.props.setShowFunction(this.showFlyout);\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (typeof this.props.unsetShowFunction === 'function') {\n        this.props.unsetShowFunction();\n      }\n    }\n  }, {\n    key: 'extractJob',\n    value: function extractJob(job, hasDatafeed) {\n      var mml = job.analysis_limits && job.analysis_limits.model_memory_limit ? job.analysis_limits.model_memory_limit : '';\n      var detectors = job.analysis_config && job.analysis_config.detectors ? job.analysis_config.detectors : '';\n\n      var bucketSpan = job.analysis_config ? job.analysis_config.bucket_span : '';\n\n      var datafeedConfig = job.datafeed_config;\n      var frequency = datafeedConfig.frequency !== undefined ? datafeedConfig.frequency : '';\n      var customUrls = job.custom_settings && job.custom_settings.custom_urls ? job.custom_settings.custom_urls : [];\n\n      this.setState({\n        job: job,\n        hasDatafeed: hasDatafeed,\n        jobDescription: job.description,\n        jobGroups: job.groups !== undefined ? job.groups : [],\n        jobModelMemoryLimit: mml,\n        jobDetectors: detectors,\n        jobDetectorDescriptions: detectors.map(function (d) {\n          return d.detector_description;\n        }),\n        jobBucketSpan: bucketSpan,\n        jobCustomUrls: customUrls,\n        datafeedQuery: hasDatafeed ? JSON.stringify(datafeedConfig.query, null, 2) : '',\n        datafeedQueryDelay: hasDatafeed ? datafeedConfig.query_delay : '',\n        datafeedFrequency: hasDatafeed ? frequency : '',\n        datafeedScrollSize: hasDatafeed ? +datafeedConfig.scroll_size : '',\n        jobModelMemoryLimitValidationError: '',\n        jobGroupsValidationError: ''\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var flyout = void 0;\n\n      if (this.state.isFlyoutVisible) {\n        var _state = this.state,\n            job = _state.job,\n            jobDescription = _state.jobDescription,\n            jobGroups = _state.jobGroups,\n            jobModelMemoryLimit = _state.jobModelMemoryLimit,\n            jobDetectors = _state.jobDetectors,\n            jobDetectorDescriptions = _state.jobDetectorDescriptions,\n            jobBucketSpan = _state.jobBucketSpan,\n            jobCustomUrls = _state.jobCustomUrls,\n            datafeedQuery = _state.datafeedQuery,\n            datafeedQueryDelay = _state.datafeedQueryDelay,\n            datafeedFrequency = _state.datafeedFrequency,\n            datafeedScrollSize = _state.datafeedScrollSize,\n            jobGroupsValidationError = _state.jobGroupsValidationError,\n            jobModelMemoryLimitValidationError = _state.jobModelMemoryLimitValidationError,\n            isValidJobDetails = _state.isValidJobDetails,\n            isValidJobCustomUrls = _state.isValidJobCustomUrls;\n        var intl = this.props.intl;\n\n\n        var tabs = [{\n          id: 'job-details',\n          name: intl.formatMessage({\n            id: 'xpack.ml.jobsList.editJobFlyout.jobDetailsTitle',\n            defaultMessage: 'Job details'\n          }),\n          content: _react2.default.createElement(_tabs.JobDetails, {\n            jobDescription: jobDescription,\n            jobGroups: jobGroups,\n            jobModelMemoryLimit: jobModelMemoryLimit,\n            setJobDetails: this.setJobDetails,\n            jobGroupsValidationError: jobGroupsValidationError,\n            jobModelMemoryLimitValidationError: jobModelMemoryLimitValidationError\n          })\n        }, {\n          id: 'detectors',\n          name: intl.formatMessage({\n            id: 'xpack.ml.jobsList.editJobFlyout.detectorsTitle',\n            defaultMessage: 'Detectors'\n          }),\n          content: _react2.default.createElement(_tabs.Detectors, {\n            jobDetectors: jobDetectors,\n            jobDetectorDescriptions: jobDetectorDescriptions,\n            setDetectorDescriptions: this.setDetectorDescriptions\n          })\n        }, {\n          id: 'datafeed',\n          name: intl.formatMessage({\n            id: 'xpack.ml.jobsList.editJobFlyout.datafeedTitle',\n            defaultMessage: 'Datafeed'\n          }),\n          content: _react2.default.createElement(_tabs.Datafeed, {\n            datafeedQuery: datafeedQuery,\n            datafeedQueryDelay: datafeedQueryDelay,\n            datafeedFrequency: datafeedFrequency,\n            datafeedScrollSize: datafeedScrollSize,\n            jobBucketSpan: jobBucketSpan,\n            setDatafeed: this.setDatafeed\n          })\n        }, {\n          id: 'custom-urls',\n          name: intl.formatMessage({\n            id: 'xpack.ml.jobsList.editJobFlyout.customUrlsTitle',\n            defaultMessage: 'Custom URLs'\n          }),\n          content: _react2.default.createElement(_tabs.CustomUrls, {\n            job: job,\n            jobCustomUrls: jobCustomUrls,\n            setCustomUrls: this.setCustomUrls\n          })\n        }];\n\n        flyout = _react2.default.createElement(\n          _eui.EuiFlyout\n          // ownFocus\n          ,\n          { onClose: this.closeFlyout,\n            size: 'm'\n          },\n          _react2.default.createElement(\n            _eui.EuiFlyoutHeader,\n            null,\n            _react2.default.createElement(\n              _eui.EuiTitle,\n              null,\n              _react2.default.createElement(\n                'h2',\n                null,\n                _react2.default.createElement(_react3.FormattedMessage, {\n                  id: 'xpack.ml.jobsList.editJobFlyout.pageTitle',\n                  defaultMessage: 'Edit {jobId}',\n                  values: { jobId: job.id }\n                })\n              )\n            )\n          ),\n          _react2.default.createElement(\n            _eui.EuiFlyoutBody,\n            null,\n            _react2.default.createElement(_eui.EuiTabbedContent, {\n              tabs: tabs,\n              initialSelectedTab: tabs[0],\n              onTabClick: function onTabClick() {}\n            })\n          ),\n          _react2.default.createElement(\n            _eui.EuiFlyoutFooter,\n            null,\n            _react2.default.createElement(\n              _eui.EuiFlexGroup,\n              { justifyContent: 'spaceBetween' },\n              _react2.default.createElement(\n                _eui.EuiFlexItem,\n                { grow: false },\n                _react2.default.createElement(\n                  _eui.EuiButtonEmpty,\n                  {\n                    iconType: 'cross',\n                    onClick: this.closeFlyout,\n                    flush: 'left'\n                  },\n                  _react2.default.createElement(_react3.FormattedMessage, {\n                    id: 'xpack.ml.jobsList.editJobFlyout.closeButtonLabel',\n                    defaultMessage: 'Close'\n                  })\n                )\n              ),\n              _react2.default.createElement(\n                _eui.EuiFlexItem,\n                { grow: false },\n                _react2.default.createElement(\n                  _eui.EuiButton,\n                  {\n                    onClick: this.save,\n                    fill: true,\n                    isDisabled: isValidJobDetails === false || isValidJobCustomUrls === false\n                  },\n                  _react2.default.createElement(_react3.FormattedMessage, {\n                    id: 'xpack.ml.jobsList.editJobFlyout.saveButtonLabel',\n                    defaultMessage: 'Save'\n                  })\n                )\n              )\n            )\n          )\n        );\n      }\n\n      return _react2.default.createElement(\n        'div',\n        null,\n        flyout\n      );\n    }\n  }]);\n\n  return EditJobFlyoutUI;\n}(_react.Component);\n\nEditJobFlyoutUI.propTypes = {\n  setShowFunction: _propTypes2.default.func.isRequired,\n  unsetShowFunction: _propTypes2.default.func.isRequired,\n  refreshJobs: _propTypes2.default.func.isRequired,\n  allJobIds: _propTypes2.default.array.isRequired\n};\n\nvar EditJobFlyout = exports.EditJobFlyout = (0, _react3.injectI18n)(EditJobFlyoutUI);",null]}