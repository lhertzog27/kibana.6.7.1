{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/security/public/components/management/users/users.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/security/public/components/management/users/users.js","mtime":1567631712296},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Users = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _eui = require('@elastic/eui');\n\nvar _notify = require('ui/notify');\n\nvar _confirm_delete = require('./confirm_delete');\n\nvar _react3 = require('@kbn/i18n/react');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * or more contributor license agreements. Licensed under the Elastic License;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the Elastic License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar UsersUI = function (_Component) {\n  _inherits(UsersUI, _Component);\n\n  function UsersUI(props) {\n    _classCallCheck(this, UsersUI);\n\n    var _this = _possibleConstructorReturn(this, (UsersUI.__proto__ || Object.getPrototypeOf(UsersUI)).call(this, props));\n\n    _this.handleDelete = function (usernames, errors) {\n      var users = _this.state.users;\n\n      _this.setState({\n        selection: [],\n        showDeleteConfirmation: false,\n        users: users.filter(function (_ref) {\n          var username = _ref.username;\n\n          return !usernames.includes(username) || errors.includes(username);\n        })\n      });\n    };\n\n    _this.onCancelDelete = function () {\n      _this.setState({ showDeleteConfirmation: false });\n    };\n\n    _this.state = {\n      users: [],\n      selection: [],\n      showDeleteConfirmation: false\n    };\n    return _this;\n  }\n\n  _createClass(UsersUI, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.loadUsers();\n    }\n  }, {\n    key: 'loadUsers',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var apiClient, users;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                apiClient = this.props.apiClient;\n                _context.prev = 1;\n                _context.next = 4;\n                return apiClient.getUsers();\n\n              case 4:\n                users = _context.sent;\n\n                this.setState({ users: users });\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context['catch'](1);\n\n                if (_context.t0.status === 403) {\n                  this.setState({ permissionDenied: true });\n                } else {\n                  _notify.toastNotifications.addDanger(this.props.intl.formatMessage({\n                    id: \"xpack.security.management.users.fetchingUsersErrorMessage\",\n                    defaultMessage: \"Error fetching users: {message}\"\n                  }, { message: _context.t0.data.message }));\n                }\n\n              case 11:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 8]]);\n      }));\n\n      function loadUsers() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return loadUsers;\n    }()\n  }, {\n    key: 'renderToolsLeft',\n    value: function renderToolsLeft() {\n      var _this2 = this;\n\n      var selection = this.state.selection;\n\n      if (selection.length === 0) {\n        return;\n      }\n      var numSelected = selection.length;\n      return _react2.default.createElement(\n        _eui.EuiButton,\n        {\n          'data-test-subj': 'deleteUserButton',\n          color: 'danger',\n          onClick: function onClick() {\n            return _this2.setState({ showDeleteConfirmation: true });\n          }\n        },\n        _react2.default.createElement(_react3.FormattedMessage, {\n          id: 'xpack.security.management.users.deleteUsersButtonLabel',\n          defaultMessage: 'Delete {numSelected} user{numSelected, plural, one { } other {s}}',\n          values: {\n            numSelected: numSelected\n          }\n        })\n      );\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _state = this.state,\n          users = _state.users,\n          filter = _state.filter,\n          permissionDenied = _state.permissionDenied,\n          showDeleteConfirmation = _state.showDeleteConfirmation,\n          selection = _state.selection;\n      var _props = this.props,\n          apiClient = _props.apiClient,\n          intl = _props.intl;\n\n      if (permissionDenied) {\n        return _react2.default.createElement(\n          'div',\n          { className: 'mgtUsersListingPage' },\n          _react2.default.createElement(\n            _eui.EuiPageContent,\n            { horizontalPosition: 'center' },\n            _react2.default.createElement(_eui.EuiEmptyPrompt, {\n              iconType: 'securityApp',\n              iconColor: null,\n              title: _react2.default.createElement(\n                'h2',\n                null,\n                _react2.default.createElement(_react3.FormattedMessage, {\n                  id: 'xpack.security.management.users.deniedPermissionTitle',\n                  defaultMessage: 'Permission denied'\n                })\n              ),\n              body: _react2.default.createElement(\n                'p',\n                { 'data-test-subj': 'permissionDeniedMessage' },\n                _react2.default.createElement(_react3.FormattedMessage, {\n                  id: 'xpack.security.management.users.permissionDeniedToManageUsersDescription',\n                  defaultMessage: 'You do not have permission to manage users.'\n                })\n              )\n            })\n          )\n        );\n      }\n      var path = '#/management/security/';\n      var columns = [{\n        field: 'full_name',\n        name: intl.formatMessage({ id: \"xpack.security.management.users.fullNameColumnName\", defaultMessage: \"Full Name\" }),\n        sortable: true,\n        truncateText: true,\n        render: function render(fullName) {\n          return _react2.default.createElement(\n            'div',\n            { 'data-test-subj': 'userRowFullName' },\n            fullName\n          );\n        }\n      }, {\n        field: 'username',\n        name: intl.formatMessage({ id: \"xpack.security.management.users.userNameColumnName\", defaultMessage: \"User Name\" }),\n        sortable: true,\n        truncateText: true,\n        render: function render(username) {\n          return _react2.default.createElement(\n            _eui.EuiLink,\n            { 'data-test-subj': 'userRowUserName', href: path + 'users/edit/' + username },\n            username\n          );\n        }\n      }, {\n        field: 'email',\n        name: intl.formatMessage({\n          id: \"xpack.security.management.users.emailAddressColumnName\",\n          defaultMessage: \"Email Address\"\n        }),\n        sortable: true,\n        truncateText: true\n      }, {\n        field: 'roles',\n        name: intl.formatMessage({ id: \"xpack.security.management.users.rolesColumnName\", defaultMessage: \"Roles\" }),\n        render: function render(rolenames) {\n          var roleLinks = rolenames.map(function (rolename, index) {\n            return _react2.default.createElement(\n              _react.Fragment,\n              { key: rolename },\n              _react2.default.createElement(\n                _eui.EuiLink,\n                { href: path + 'roles/edit/' + rolename },\n                rolename\n              ),\n              index === rolenames.length - 1 ? null : ', '\n            );\n          });\n          return _react2.default.createElement(\n            'div',\n            { 'data-test-subj': 'userRowRoles' },\n            roleLinks\n          );\n        }\n      }, {\n        field: 'metadata._reserved',\n        name: intl.formatMessage({ id: \"xpack.security.management.users.reservedColumnName\", defaultMessage: \"Reserved\" }),\n        sortable: false,\n        width: '100px',\n        align: 'right',\n        description: intl.formatMessage({\n          id: \"xpack.security.management.users.reservedColumnDescription\",\n          defaultMessage: \"Reserved users are built-in and cannot be removed. Only the password can be changed.\"\n        }),\n        render: function render(reserved) {\n          return reserved ? _react2.default.createElement(_eui.EuiIcon, { 'aria-label': 'Reserved user', 'data-test-subj': 'reservedUser', type: 'check' }) : null;\n        }\n      }];\n      var pagination = {\n        initialPageSize: 20,\n        pageSizeOptions: [10, 20, 50, 100]\n      };\n\n      var selectionConfig = {\n        itemId: 'username',\n        selectable: function selectable(user) {\n          return !user.metadata._reserved;\n        },\n        selectableMessage: function selectableMessage(selectable) {\n          return !selectable ? 'User is a system user' : undefined;\n        },\n        onSelectionChange: function onSelectionChange(selection) {\n          return _this3.setState({ selection: selection });\n        }\n      };\n      var search = {\n        toolsLeft: this.renderToolsLeft(),\n        box: {\n          incremental: true\n        },\n        onChange: function onChange(query) {\n          _this3.setState({\n            filter: query.queryText\n          });\n        }\n      };\n      var sorting = {\n        sort: {\n          field: 'full_name',\n          direction: 'asc'\n        }\n      };\n      var rowProps = function rowProps() {\n        return {\n          'data-test-subj': 'userRow'\n        };\n      };\n      var usersToShow = filter ? users.filter(function (_ref3) {\n        var username = _ref3.username,\n            roles = _ref3.roles,\n            _ref3$full_name = _ref3.full_name,\n            fullName = _ref3$full_name === undefined ? '' : _ref3$full_name,\n            _ref3$email = _ref3.email,\n            email = _ref3$email === undefined ? '' : _ref3$email;\n\n        var normalized = (username + ' ' + roles.join(' ') + ' ' + fullName + ' ' + email).toLowerCase();\n        var normalizedQuery = filter.toLowerCase();\n        return normalized.indexOf(normalizedQuery) !== -1;\n      }) : users;\n      return _react2.default.createElement(\n        'div',\n        { className: 'mgtUsersListingPage' },\n        _react2.default.createElement(\n          _eui.EuiPageContent,\n          { className: 'mgtUsersListingPage__content' },\n          _react2.default.createElement(\n            _eui.EuiPageContentHeader,\n            null,\n            _react2.default.createElement(\n              _eui.EuiPageContentHeaderSection,\n              null,\n              _react2.default.createElement(\n                _eui.EuiTitle,\n                null,\n                _react2.default.createElement(\n                  'h2',\n                  null,\n                  _react2.default.createElement(_react3.FormattedMessage, {\n                    id: 'xpack.security.management.users.usersTitle',\n                    defaultMessage: 'Users'\n                  })\n                )\n              )\n            ),\n            _react2.default.createElement(\n              _eui.EuiPageContentHeaderSection,\n              null,\n              _react2.default.createElement(\n                _eui.EuiButton,\n                {\n                  'data-test-subj': 'createUserButton',\n                  href: '#/management/security/users/edit'\n                },\n                _react2.default.createElement(_react3.FormattedMessage, {\n                  id: 'xpack.security.management.users.createNewUserButtonLabel',\n                  defaultMessage: 'Create new user'\n                })\n              )\n            )\n          ),\n          _react2.default.createElement(\n            _eui.EuiPageContentBody,\n            null,\n            showDeleteConfirmation ? _react2.default.createElement(_confirm_delete.ConfirmDelete, {\n              onCancel: this.onCancelDelete,\n              apiClient: apiClient,\n              usersToDelete: selection.map(function (user) {\n                return user.username;\n              }),\n              callback: this.handleDelete\n            }) : null,\n            _react2.default.createElement(_eui.EuiInMemoryTable, {\n              itemId: 'username',\n              columns: columns,\n              selection: selectionConfig,\n              pagination: pagination,\n              items: usersToShow,\n              loading: users.length === 0,\n              search: search,\n              sorting: sorting,\n              rowProps: rowProps,\n              isSelectable: true\n            })\n          )\n        )\n      );\n    }\n  }]);\n\n  return UsersUI;\n}(_react.Component);\n\nvar Users = exports.Users = (0, _react3.injectI18n)(UsersUI);",null]}