{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--9-1!/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js??ref--9-2!/home/anthony/git_workspaces/kibana/src/legacy/core_plugins/kibana/public/home/components/tutorial/tutorial.js","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/src/legacy/core_plugins/kibana/public/home/components/tutorial/tutorial.js","mtime":1567631711568},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/babel-loader/lib/index.js","mtime":1567666227676}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Tutorial = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _footer = require('./footer');\n\nvar _introduction = require('./introduction');\n\nvar _instruction_set = require('./instruction_set');\n\nvar _saved_objects_installer = require('./saved_objects_installer');\n\nvar _eui = require('@elastic/eui');\n\nvar _status_check_states = require('./status_check_states');\n\nvar StatusCheckStates = _interopRequireWildcard(_status_check_states);\n\nvar _react3 = require('@kbn/i18n/react');\n\nvar _i18n = require('@kbn/i18n');\n\nvar _chrome = require('ui/chrome');\n\nvar _chrome2 = _interopRequireDefault(_chrome);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed to Elasticsearch B.V. under one or more contributor\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * license agreements. See the NOTICE file distributed with\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * this work for additional information regarding copyright\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * ownership. Elasticsearch B.V. licenses this file to you under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the Apache License, Version 2.0 (the \"License\"); you may\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * not use this file except in compliance with the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *    http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar INSTRUCTIONS_TYPE = {\n  ELASTIC_CLOUD: 'elasticCloud',\n  ON_PREM: 'onPrem',\n  ON_PREM_ELASTIC_CLOUD: 'onPremElasticCloud'\n};\n\nvar homeTitle = _i18n.i18n.translate('kbn.home.breadcrumbs.homeTitle', { defaultMessage: 'Home' });\nvar addDataTitle = _i18n.i18n.translate('kbn.home.breadcrumbs.addDataTitle', { defaultMessage: 'Add data' });\n\nvar TutorialUi = function (_React$Component) {\n  _inherits(TutorialUi, _React$Component);\n\n  function TutorialUi(props) {\n    var _this2 = this;\n\n    _classCallCheck(this, TutorialUi);\n\n    var _this = _possibleConstructorReturn(this, (TutorialUi.__proto__ || Object.getPrototypeOf(TutorialUi)).call(this, props));\n\n    _this.getInstructions = function () {\n      if (!_this.state.tutorial) {\n        return { instructionSets: [] };\n      }\n\n      switch (_this.state.visibleInstructions) {\n        case INSTRUCTIONS_TYPE.ELASTIC_CLOUD:\n          return _this.state.tutorial.elasticCloud;\n        case INSTRUCTIONS_TYPE.ON_PREM:\n          return _this.state.tutorial.onPrem;\n        case INSTRUCTIONS_TYPE.ON_PREM_ELASTIC_CLOUD:\n          return _this.state.tutorial.onPremElasticCloud;\n        default:\n          throw new Error(_this.props.intl.formatMessage({\n            id: 'kbn.home.tutorial.unhandledInstructionTypeErrorDescription',\n            defaultMessage: 'Unhandled instruction type {visibleInstructions}'\n          }, {\n            visibleInstructions: _this.state.visibleInstructions\n          }));\n      }\n    };\n\n    _this.getInstructionSets = function () {\n      return _this.getInstructions().instructionSets;\n    };\n\n    _this.initInstructionsState = function () {\n      var instructions = _this.getInstructions();\n\n      var paramValues = {};\n      if (instructions.params) {\n        instructions.params.forEach(function (param) {\n          paramValues[param.id] = param.defaultValue;\n        });\n      }\n\n      var statusCheckStates = new Array(instructions.instructionSets.length).fill(StatusCheckStates.NOT_CHECKED);\n\n      _this.setState({\n        paramValues: paramValues,\n        statusCheckStates: statusCheckStates\n      });\n    };\n\n    _this.setVisibleInstructions = function (instructionsType) {\n      _this.setState({\n        visibleInstructions: instructionsType\n      }, _this.initInstructionsState);\n    };\n\n    _this.setParameter = function (paramId, newValue) {\n      _this.setState(function (previousState) {\n        var paramValues = _lodash2.default.cloneDeep(previousState.paramValues);\n        paramValues[paramId] = newValue;\n        return { paramValues: paramValues };\n      });\n    };\n\n    _this.checkInstructionSetStatus = function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(instructionSetIndex) {\n        var instructionSet, esHitsCheckConfig, statusCheckState;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                instructionSet = _this.getInstructionSets()[instructionSetIndex];\n                esHitsCheckConfig = _lodash2.default.get(instructionSet, 'statusCheck.esHitsCheck');\n\n                if (!esHitsCheckConfig) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 5;\n                return _this.fetchEsHitsStatus(esHitsCheckConfig);\n\n              case 5:\n                statusCheckState = _context.sent;\n\n\n                _this.setState(function (prevState) {\n                  return {\n                    statusCheckStates: _extends({}, prevState.statusCheckStates, _defineProperty({}, instructionSetIndex, statusCheckState))\n                  };\n                });\n\n              case 7:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, _this2);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.fetchEsHitsStatus = function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(esHitsCheckConfig) {\n        var searchHeader, searchBody, response, results, numHits;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                searchHeader = JSON.stringify({ index: esHitsCheckConfig.index });\n                searchBody = JSON.stringify({ query: esHitsCheckConfig.query, size: 1 });\n                _context2.next = 4;\n                return fetch(_this.props.addBasePath('/elasticsearch/_msearch'), {\n                  method: 'post',\n                  body: searchHeader + '\\n' + searchBody + '\\n',\n                  headers: {\n                    accept: 'application/json',\n                    'content-type': 'application/x-ndjson',\n                    'kbn-xsrf': 'kibana'\n                  },\n                  credentials: 'same-origin'\n                });\n\n              case 4:\n                response = _context2.sent;\n\n                if (!(response.status > 300)) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                return _context2.abrupt('return', StatusCheckStates.ERROR);\n\n              case 7:\n                _context2.next = 9;\n                return response.json();\n\n              case 9:\n                results = _context2.sent;\n                numHits = _lodash2.default.get(results, 'responses.[0].hits.hits.length', 0);\n                return _context2.abrupt('return', numHits === 0 ? StatusCheckStates.NO_DATA : StatusCheckStates.HAS_DATA);\n\n              case 12:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, _this2);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.renderInstructionSetsToggle = function () {\n      if (!_this.props.isCloudEnabled && _this.state.tutorial.onPremElasticCloud) {\n        var selfManagedLabel = _this.props.intl.formatMessage({ id: 'kbn.home.tutorial.selfManagedButtonLabel',\n          defaultMessage: 'Self managed' });\n        var cloudLabel = _this.props.intl.formatMessage({ id: 'kbn.home.tutorial.elasticCloudButtonLabel',\n          defaultMessage: 'Elastic Cloud' });\n        var radioButtons = [{\n          id: INSTRUCTIONS_TYPE.ON_PREM,\n          label: selfManagedLabel\n        }, {\n          id: INSTRUCTIONS_TYPE.ON_PREM_ELASTIC_CLOUD,\n          label: cloudLabel\n        }];\n        return _react2.default.createElement(\n          _eui.EuiFlexGroup,\n          { justifyContent: 'center' },\n          _react2.default.createElement(\n            _eui.EuiFlexItem,\n            { grow: false },\n            _react2.default.createElement(_eui.EuiButtonGroup, {\n              options: radioButtons,\n              idSelected: _this.state.visibleInstructions,\n              onChange: _this.setVisibleInstructions,\n              color: 'primary'\n            })\n          )\n        );\n      }\n    };\n\n    _this.onStatusCheck = function (instructionSetIndex) {\n      _this.setState(function (prevState) {\n        return {\n          statusCheckStates: _extends({}, prevState.statusCheckStates, _defineProperty({}, instructionSetIndex, StatusCheckStates.FETCHING))\n        };\n      }, _this.checkInstructionSetStatus.bind(null, instructionSetIndex));\n    };\n\n    _this.renderInstructionSets = function (instructions) {\n      var offset = 1;\n      return instructions.instructionSets.map(function (instructionSet, index) {\n        var currentOffset = offset;\n        offset += instructionSet.instructionVariants[0].instructions.length;\n\n        return _react2.default.createElement(_instruction_set.InstructionSet, {\n          title: instructionSet.title,\n          instructionVariants: instructionSet.instructionVariants,\n          statusCheckConfig: instructionSet.statusCheck,\n          statusCheckState: _this.state.statusCheckStates[index],\n          onStatusCheck: function onStatusCheck() {\n            _this.onStatusCheck(index);\n          },\n          offset: currentOffset,\n          params: instructions.params,\n          paramValues: _this.state.paramValues,\n          setParameter: _this.setParameter,\n          replaceTemplateStrings: _this.props.replaceTemplateStrings,\n          key: index\n        });\n      });\n    };\n\n    _this.renderSavedObjectsInstaller = function () {\n      if (!_this.state.tutorial.savedObjects) {\n        return;\n      }\n\n      return _react2.default.createElement(_saved_objects_installer.SavedObjectsInstaller, {\n        bulkCreate: _this.props.bulkCreate,\n        savedObjects: _this.state.tutorial.savedObjects,\n        installMsg: _this.state.tutorial.savedObjectsInstallMsg\n      });\n    };\n\n    _this.renderFooter = function () {\n      var label = void 0;\n      var url = void 0;\n      if (_lodash2.default.has(_this.state, 'tutorial.artifacts.application')) {\n        label = _this.state.tutorial.artifacts.application.label;\n        url = _this.props.addBasePath(_this.state.tutorial.artifacts.application.path);\n      } else if (_lodash2.default.has(_this.state, 'tutorial.artifacts.dashboards')) {\n        var overviewDashboard = _this.state.tutorial.artifacts.dashboards.find(function (dashboard) {\n          return dashboard.isOverview;\n        });\n        if (overviewDashboard) {\n          label = overviewDashboard.linkLabel;\n          url = _this.props.addBasePath('/app/kibana#/dashboard/' + overviewDashboard.id);\n        }\n      }\n\n      if (url && label) {\n        return _react2.default.createElement(_footer.Footer, {\n          label: label,\n          url: url\n        });\n      }\n    };\n\n    _this.state = {\n      notFound: false,\n      paramValues: {},\n      statusCheckStates: [],\n      tutorial: null\n    };\n\n    if (props.isCloudEnabled) {\n      _this.state.visibleInstructions = INSTRUCTIONS_TYPE.ELASTIC_CLOUD;\n    } else {\n      _this.state.visibleInstructions = INSTRUCTIONS_TYPE.ON_PREM;\n    }\n    return _this;\n  }\n\n  _createClass(TutorialUi, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      this._isMounted = true;\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var tutorial;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.props.getTutorial(this.props.tutorialId);\n\n              case 2:\n                tutorial = _context3.sent;\n\n                if (this._isMounted) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                return _context3.abrupt('return');\n\n              case 5:\n\n                if (tutorial) {\n                  // eslint-disable-next-line react/no-did-mount-set-state\n                  this.setState({\n                    tutorial: tutorial\n                  }, this.initInstructionsState);\n                } else {\n                  // eslint-disable-next-line react/no-did-mount-set-state\n                  this.setState({\n                    notFound: true\n                  });\n                }\n\n                if (this.props.isK7Design) {\n                  _chrome2.default.breadcrumbs.set([{\n                    text: homeTitle,\n                    href: '#/home'\n                  }, {\n                    text: addDataTitle,\n                    href: '#/home/tutorial_directory'\n                  }, {\n                    text: tutorial ? tutorial.name : this.props.tutorialId\n                  }]);\n                }\n\n              case 7:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _ref3.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n\n    /**\n     *\n     * @param esHitsCheckConfig\n     * @return {Promise<string>}\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var content = void 0;\n      if (this.state.notFound) {\n        content = _react2.default.createElement(\n          'div',\n          { className: 'homTutorial__notFoundPanel' },\n          _react2.default.createElement(\n            _eui.EuiText,\n            null,\n            _react2.default.createElement(\n              'p',\n              null,\n              _react2.default.createElement(_react3.FormattedMessage, {\n                id: 'kbn.home.tutorial.noTutorialLabel',\n                defaultMessage: 'Unable to find tutorial {tutorialId}',\n                values: { tutorialId: this.props.tutorialId }\n              })\n            )\n          )\n        );\n      }\n\n      if (this.state.tutorial) {\n        var previewUrl = void 0;\n        if (this.state.tutorial.previewImagePath) {\n          previewUrl = this.props.addBasePath(this.state.tutorial.previewImagePath);\n        }\n\n        var exportedFieldsUrl = void 0;\n        if (_lodash2.default.has(this.state, 'tutorial.artifacts.exportedFields')) {\n          exportedFieldsUrl = this.props.replaceTemplateStrings(this.state.tutorial.artifacts.exportedFields.documentationUrl);\n        }\n\n        var instructions = this.getInstructions();\n        content = _react2.default.createElement(\n          'div',\n          null,\n          _react2.default.createElement(_introduction.Introduction, {\n            title: this.state.tutorial.name,\n            description: this.props.replaceTemplateStrings(this.state.tutorial.longDescription),\n            previewUrl: previewUrl,\n            exportedFieldsUrl: exportedFieldsUrl,\n            iconType: this.state.tutorial.euiIconType,\n            isBeta: this.state.tutorial.isBeta\n          }),\n          _react2.default.createElement(_eui.EuiSpacer, null),\n          _react2.default.createElement(\n            'div',\n            { className: 'eui-textCenter' },\n            this.renderInstructionSetsToggle()\n          ),\n          _react2.default.createElement(_eui.EuiSpacer, null),\n          _react2.default.createElement(\n            _eui.EuiPanel,\n            { paddingSize: 'l' },\n            this.renderInstructionSets(instructions),\n            this.renderSavedObjectsInstaller(),\n            this.renderFooter()\n          )\n        );\n      }\n\n      var breadcrumbs = void 0;\n      if (!this.props.isK7Design) {\n        breadcrumbs = _react2.default.createElement(\n          _react.Fragment,\n          null,\n          _react2.default.createElement(\n            'div',\n            null,\n            _react2.default.createElement(\n              _eui.EuiLink,\n              { href: '#/home' },\n              homeTitle\n            ),\n            ' /',\n            ' ',\n            _react2.default.createElement(\n              _eui.EuiLink,\n              { href: '#/home/tutorial_directory' },\n              addDataTitle\n            ),\n            ' /',\n            ' ',\n            this.state.tutorial ? this.state.tutorial.name : this.props.tutorialId\n          ),\n          _react2.default.createElement(_eui.EuiSpacer, { size: 's' })\n        );\n      }\n\n      return _react2.default.createElement(\n        _eui.EuiPage,\n        { className: 'homPage' },\n        _react2.default.createElement(\n          _eui.EuiPageBody,\n          null,\n          breadcrumbs,\n          content\n        )\n      );\n    }\n  }]);\n\n  return TutorialUi;\n}(_react2.default.Component);\n\nTutorialUi.propTypes = {\n  addBasePath: _propTypes2.default.func.isRequired,\n  isCloudEnabled: _propTypes2.default.bool.isRequired,\n  getTutorial: _propTypes2.default.func.isRequired,\n  replaceTemplateStrings: _propTypes2.default.func.isRequired,\n  tutorialId: _propTypes2.default.string.isRequired,\n  bulkCreate: _propTypes2.default.func.isRequired,\n  isK7Design: _propTypes2.default.bool.isRequired\n};\n\nvar Tutorial = exports.Tutorial = (0, _react3.injectI18n)(TutorialUi);",null]}