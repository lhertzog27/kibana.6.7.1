{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/store/urlParams.ts","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/store/urlParams.ts","mtime":1567631711872},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { compact, pick } from 'lodash';\nimport { createSelector } from 'reselect';\nimport { legacyDecodeURIComponent, toQuery } from '../components/shared/Links/url_helpers';\n// @ts-ignore\nimport { LOCATION_UPDATE } from './location';\nimport { getDefaultTransactionType } from './reactReduxRequest/serviceDetails';\nimport { getDefaultDistributionSample } from './reactReduxRequest/transactionDistribution';\n// ACTION TYPES\nexport var TIMEPICKER_UPDATE = 'TIMEPICKER_UPDATE';\n// \"urlParams\" contains path and query parameters from the url, that can be easily consumed from\n// any (container) component with access to the store\n// Example:\n// url: /opbeans-backend/Brewing%20Bot?transactionId=1321\n// serviceName: opbeans-backend (path param)\n// transactionType: Brewing%20Bot (path param)\n// transactionId: 1321 (query param)\nexport function urlParamsReducer(state, action) {\n    if (state === void 0) { state = {}; }\n    switch (action.type) {\n        case LOCATION_UPDATE: {\n            var _a = getPathParams(action.location.pathname), processorEvent = _a.processorEvent, serviceName = _a.serviceName, transactionName = _a.transactionName, transactionType = _a.transactionType, errorGroupId = _a.errorGroupId;\n            var _b = toQuery(action.location.search), traceId = _b.traceId, transactionId = _b.transactionId, detailTab = _b.detailTab, flyoutDetailTab = _b.flyoutDetailTab, waterfallItemId = _b.waterfallItemId, spanId = _b.spanId, page = _b.page, sortDirection = _b.sortDirection, sortField = _b.sortField, kuery = _b.kuery;\n            return removeUndefinedProps(tslib_1.__assign({}, state, { \n                // query params\n                sortDirection: sortDirection,\n                sortField: sortField, page: toNumber(page) || 0, transactionId: toString(transactionId), traceId: toString(traceId), waterfallItemId: toString(waterfallItemId), detailTab: toString(detailTab), flyoutDetailTab: toString(flyoutDetailTab), spanId: toNumber(spanId), kuery: legacyDecodeURIComponent(kuery), \n                // path params\n                processorEvent: processorEvent,\n                serviceName: serviceName, transactionType: legacyDecodeURIComponent(transactionType), transactionName: legacyDecodeURIComponent(transactionName), errorGroupId: errorGroupId }));\n        }\n        case TIMEPICKER_UPDATE:\n            return tslib_1.__assign({}, state, { start: action.time.min, end: action.time.max });\n        default:\n            return state;\n    }\n}\nfunction toNumber(value) {\n    if (value !== undefined && !Array.isArray(value)) {\n        return parseInt(value, 10);\n    }\n}\nfunction toString(str) {\n    if (str === '' ||\n        str === 'null' ||\n        str === 'undefined' ||\n        Array.isArray(str)) {\n        return;\n    }\n    return str;\n}\nfunction getPathAsArray(pathname) {\n    return compact(pathname.split('/'));\n}\nfunction removeUndefinedProps(obj) {\n    return pick(obj, function (value) { return value !== undefined; });\n}\nfunction getPathParams(pathname) {\n    var paths = getPathAsArray(pathname);\n    var pageName = paths[1];\n    switch (pageName) {\n        case 'transactions':\n            return {\n                processorEvent: 'transaction',\n                serviceName: paths[0],\n                transactionType: paths[2],\n                transactionName: paths[3]\n            };\n        case 'errors':\n            return {\n                processorEvent: 'error',\n                serviceName: paths[0],\n                errorGroupId: paths[2]\n            };\n        case 'metrics':\n            return {\n                processorEvent: 'metric',\n                serviceName: paths[0]\n            };\n        default:\n            return {};\n    }\n}\n// ACTION CREATORS\nexport function updateTimePicker(time) {\n    return { type: TIMEPICKER_UPDATE, time: time };\n}\n// Selectors\nexport var getUrlParams = createSelector(function (state) { return state.urlParams; }, getDefaultTransactionType, getDefaultDistributionSample, function (urlParams, transactionType, _a) {\n    var traceId = _a.traceId, transactionId = _a.transactionId;\n    return tslib_1.__assign({ transactionType: transactionType,\n        transactionId: transactionId,\n        traceId: traceId }, urlParams);\n});\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/store/urlParams.ts","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/store/urlParams.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport { compact, pick } from 'lodash';\nimport { AnyAction } from 'redux';\nimport { createSelector } from 'reselect';\nimport {\n  legacyDecodeURIComponent,\n  toQuery\n} from '../components/shared/Links/url_helpers';\n// @ts-ignore\nimport { LOCATION_UPDATE } from './location';\nimport { getDefaultTransactionType } from './reactReduxRequest/serviceDetails';\nimport { getDefaultDistributionSample } from './reactReduxRequest/transactionDistribution';\nimport { IReduxState } from './rootReducer';\n\n// ACTION TYPES\nexport const TIMEPICKER_UPDATE = 'TIMEPICKER_UPDATE';\n\n// \"urlParams\" contains path and query parameters from the url, that can be easily consumed from\n// any (container) component with access to the store\n\n// Example:\n// url: /opbeans-backend/Brewing%20Bot?transactionId=1321\n// serviceName: opbeans-backend (path param)\n// transactionType: Brewing%20Bot (path param)\n// transactionId: 1321 (query param)\nexport function urlParamsReducer(state = {}, action: AnyAction) {\n  switch (action.type) {\n    case LOCATION_UPDATE: {\n      const {\n        processorEvent,\n        serviceName,\n        transactionName,\n        transactionType,\n        errorGroupId\n      } = getPathParams(action.location.pathname);\n\n      const {\n        traceId,\n        transactionId,\n        detailTab,\n        flyoutDetailTab,\n        waterfallItemId,\n        spanId,\n        page,\n        sortDirection,\n        sortField,\n        kuery\n      } = toQuery(action.location.search);\n\n      return removeUndefinedProps({\n        ...state,\n\n        // query params\n        sortDirection,\n        sortField,\n        page: toNumber(page) || 0,\n        transactionId: toString(transactionId),\n        traceId: toString(traceId),\n        waterfallItemId: toString(waterfallItemId),\n        detailTab: toString(detailTab),\n        flyoutDetailTab: toString(flyoutDetailTab),\n        spanId: toNumber(spanId),\n        kuery: legacyDecodeURIComponent(kuery as string | undefined),\n\n        // path params\n        processorEvent,\n        serviceName,\n        transactionType: legacyDecodeURIComponent(transactionType),\n        transactionName: legacyDecodeURIComponent(transactionName),\n        errorGroupId\n      });\n    }\n\n    case TIMEPICKER_UPDATE:\n      return { ...state, start: action.time.min, end: action.time.max };\n\n    default:\n      return state;\n  }\n}\n\nfunction toNumber(value?: string | string[]) {\n  if (value !== undefined && !Array.isArray(value)) {\n    return parseInt(value, 10);\n  }\n}\n\nfunction toString(str?: string | string[]) {\n  if (\n    str === '' ||\n    str === 'null' ||\n    str === 'undefined' ||\n    Array.isArray(str)\n  ) {\n    return;\n  }\n  return str;\n}\n\nfunction getPathAsArray(pathname: string) {\n  return compact(pathname.split('/'));\n}\n\nfunction removeUndefinedProps<T>(obj: T): Partial<T> {\n  return pick(obj, value => value !== undefined);\n}\n\nfunction getPathParams(pathname: string) {\n  const paths = getPathAsArray(pathname);\n  const pageName = paths[1];\n\n  switch (pageName) {\n    case 'transactions':\n      return {\n        processorEvent: 'transaction',\n        serviceName: paths[0],\n        transactionType: paths[2],\n        transactionName: paths[3]\n      };\n    case 'errors':\n      return {\n        processorEvent: 'error',\n        serviceName: paths[0],\n        errorGroupId: paths[2]\n      };\n    case 'metrics':\n      return {\n        processorEvent: 'metric',\n        serviceName: paths[0]\n      };\n    default:\n      return {};\n  }\n}\n\n// ACTION CREATORS\nexport function updateTimePicker(time: string) {\n  return { type: TIMEPICKER_UPDATE, time };\n}\n\n// Selectors\nexport const getUrlParams = createSelector(\n  (state: IReduxState) => state.urlParams,\n  getDefaultTransactionType,\n  getDefaultDistributionSample,\n  (\n    urlParams,\n    transactionType: string,\n    { traceId, transactionId }\n  ): IUrlParams => {\n    return {\n      transactionType,\n      transactionId,\n      traceId,\n      ...urlParams\n    };\n  }\n);\n\nexport interface IUrlParams {\n  detailTab?: string;\n  end?: number;\n  errorGroupId?: string;\n  flyoutDetailTab?: string;\n  kuery?: string;\n  serviceName?: string;\n  sortField?: string;\n  sortDirection?: 'asc' | 'desc';\n  start?: number;\n  traceId?: string;\n  transactionId?: string;\n  transactionName?: string;\n  transactionType?: string;\n  waterfallItemId?: string;\n}\n"]}]}