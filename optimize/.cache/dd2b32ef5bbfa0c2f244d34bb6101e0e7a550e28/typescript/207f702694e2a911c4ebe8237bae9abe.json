{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/upgrade_assistant/public/components/tabs/checkup/deprecations/grouped.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/upgrade_assistant/public/components/tabs/checkup/deprecations/grouped.tsx","mtime":1567631712322},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { groupBy } from 'lodash';\nimport React, { Fragment } from 'react';\nimport { EuiAccordion, EuiBadge, EuiButtonEmpty, EuiFlexGroup, EuiFlexItem, EuiPagination, EuiSpacer, } from '@elastic/eui';\nimport { FormattedMessage } from '@kbn/i18n/react';\nimport { GroupByOption, LevelFilterOption } from '../../../types';\nimport { DeprecationCountSummary } from './count_summary';\nimport { DeprecationHealth } from './health';\nimport { DeprecationList } from './list';\n// exported only for testing\nexport var filterDeps = function (level, search) {\n    if (search === void 0) { search = ''; }\n    var conditions = [];\n    if (level !== LevelFilterOption.all) {\n        conditions.push(function (dep) { return dep.level === level; });\n    }\n    if (search.length > 0) {\n        // Change everything to lower case for a case-insensitive comparison\n        conditions.push(function (dep) {\n            try {\n                var searchReg = new RegExp(search.toLowerCase());\n                return Boolean(dep.message.toLowerCase().match(searchReg) ||\n                    (dep.details && dep.details.toLowerCase().match(searchReg)) ||\n                    (dep.index && dep.index.toLowerCase().match(searchReg)) ||\n                    (dep.node && dep.node.toLowerCase().match(searchReg)));\n            }\n            catch (e) {\n                // ignore any regexp errors.\n                return true;\n            }\n        });\n    }\n    // Return true if every condition function returns true (boolean AND)\n    return function (dep) { return conditions.map(function (c) { return c(dep); }).every(function (t) { return t; }); };\n};\n/**\n * A single accordion item for a grouped deprecation item.\n */\nexport var DeprecationAccordion = function (_a) {\n    var id = _a.id, deprecations = _a.deprecations, title = _a.title, currentGroupBy = _a.currentGroupBy, forceExpand = _a.forceExpand;\n    var hasIndices = Boolean(currentGroupBy === GroupByOption.message && deprecations.filter(function (d) { return d.index; }).length);\n    var numIndices = hasIndices ? deprecations.length : null;\n    return (React.createElement(EuiAccordion, { id: id, className: \"upgDeprecations__item\", initialIsOpen: forceExpand, buttonContent: React.createElement(\"span\", { className: \"upgDeprecations__itemName\" }, title), extraAction: React.createElement(\"div\", null,\n            hasIndices && (React.createElement(Fragment, null,\n                React.createElement(EuiBadge, { color: \"hollow\" },\n                    React.createElement(\"span\", { \"data-test-subj\": \"indexCount\" }, numIndices),\n                    ' ',\n                    React.createElement(FormattedMessage, { id: \"xpack.upgradeAssistant.checkupTab.indicesBadgeLabel\", defaultMessage: \"{numIndices, plural, one {index} other {indices}}\", values: { numIndices: numIndices } })),\n                \"\\u2003\")),\n            React.createElement(DeprecationHealth, { single: currentGroupBy === GroupByOption.message, deprecations: deprecations })) },\n        React.createElement(DeprecationList, { deprecations: deprecations, currentGroupBy: currentGroupBy })));\n};\nvar PER_PAGE = 25;\n/**\n * Collection of calculated fields based on props, extracted for reuse in\n * `render` and `getDerivedStateFromProps`.\n */\nvar CalcFields = {\n    filteredDeprecations: function (props) {\n        var _a = props.allDeprecations, allDeprecations = _a === void 0 ? [] : _a, currentFilter = props.currentFilter, search = props.search;\n        return allDeprecations.filter(filterDeps(currentFilter, search));\n    },\n    groups: function (props) {\n        var currentGroupBy = props.currentGroupBy;\n        return groupBy(CalcFields.filteredDeprecations(props), currentGroupBy);\n    },\n    numPages: function (props) {\n        return Math.ceil(Object.keys(CalcFields.groups(props)).length / PER_PAGE);\n    },\n};\n/**\n * Displays groups of deprecation messages in an accordion.\n */\nvar GroupedDeprecations = /** @class */ (function (_super) {\n    tslib_1.__extends(GroupedDeprecations, _super);\n    function GroupedDeprecations() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            forceExpand: false,\n            // `expandNumber` is used as workaround to force EuiAccordion to re-render by\n            // incrementing this number (used as a key) when expand all or collapse all is clicked.\n            expandNumber: 0,\n            currentPage: 0,\n        };\n        _this.setExpand = function (forceExpand) {\n            _this.setState({ forceExpand: forceExpand, expandNumber: _this.state.expandNumber + 1 });\n        };\n        _this.setPage = function (currentPage) { return _this.setState({ currentPage: currentPage }); };\n        return _this;\n    }\n    GroupedDeprecations.getDerivedStateFromProps = function (nextProps, _a) {\n        var currentPage = _a.currentPage;\n        // If filters change and the currentPage is now bigger than the num of pages we're going to show,\n        // reset the current page to 0.\n        if (currentPage >= CalcFields.numPages(nextProps)) {\n            return { currentPage: 0 };\n        }\n        else {\n            return null;\n        }\n    };\n    GroupedDeprecations.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, currentGroupBy = _a.currentGroupBy, _b = _a.allDeprecations, allDeprecations = _b === void 0 ? [] : _b;\n        var _c = this.state, forceExpand = _c.forceExpand, expandNumber = _c.expandNumber, currentPage = _c.currentPage;\n        var filteredDeprecations = CalcFields.filteredDeprecations(this.props);\n        var groups = CalcFields.groups(this.props);\n        return (React.createElement(Fragment, null,\n            React.createElement(EuiFlexGroup, { responsive: false, alignItems: \"center\" },\n                React.createElement(EuiFlexItem, { grow: false },\n                    React.createElement(EuiButtonEmpty, { flush: \"left\", size: \"s\", onClick: function () { return _this.setExpand(true); }, \"data-test-subj\": \"expandAll\" },\n                        React.createElement(FormattedMessage, { id: \"xpack.upgradeAssistant.checkupTab.controls.expandAllButtonLabel\", defaultMessage: \"Expand all\" }))),\n                React.createElement(EuiFlexItem, { grow: false },\n                    React.createElement(EuiButtonEmpty, { flush: \"left\", size: \"s\", onClick: function () { return _this.setExpand(false); }, \"data-test-subj\": \"collapseAll\" },\n                        React.createElement(FormattedMessage, { id: \"xpack.upgradeAssistant.checkupTab.controls.collapseAllButtonLabel\", defaultMessage: \"Collapse all\" }))),\n                React.createElement(EuiFlexItem, null),\n                React.createElement(EuiFlexItem, { grow: false },\n                    React.createElement(DeprecationCountSummary, { allDeprecations: allDeprecations, deprecations: filteredDeprecations }))),\n            React.createElement(EuiSpacer, { size: \"s\" }),\n            React.createElement(\"div\", { className: \"upgDeprecations\" },\n                Object.keys(groups)\n                    .sort()\n                    // Apply pagination\n                    .slice(currentPage * PER_PAGE, (currentPage + 1) * PER_PAGE)\n                    .map(function (groupName) { return [\n                    React.createElement(DeprecationAccordion, tslib_1.__assign({ key: expandNumber, id: \"depgroup-\" + groupName, title: groupName, deprecations: groups[groupName] }, { currentGroupBy: currentGroupBy, forceExpand: forceExpand })),\n                ]; }),\n                Object.keys(groups).length > PER_PAGE && (React.createElement(Fragment, null,\n                    React.createElement(EuiSpacer, null),\n                    React.createElement(EuiFlexGroup, { justifyContent: \"spaceAround\" },\n                        React.createElement(EuiFlexItem, { grow: false },\n                            React.createElement(EuiPagination, { pageCount: CalcFields.numPages(this.props), activePage: currentPage, onPageClick: this.setPage }))))))));\n    };\n    return GroupedDeprecations;\n}(React.Component));\nexport { GroupedDeprecations };\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/upgrade_assistant/public/components/tabs/checkup/deprecations/grouped.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/upgrade_assistant/public/components/tabs/checkup/deprecations/grouped.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport { groupBy } from 'lodash';\nimport React, { Fragment, StatelessComponent } from 'react';\n\nimport {\n  EuiAccordion,\n  EuiBadge,\n  EuiButtonEmpty,\n  EuiFlexGroup,\n  EuiFlexItem,\n  EuiPagination,\n  EuiSpacer,\n} from '@elastic/eui';\nimport { FormattedMessage } from '@kbn/i18n/react';\n\nimport { DeprecationInfo } from 'src/legacy/core_plugins/elasticsearch';\nimport { EnrichedDeprecationInfo } from '../../../../../server/lib/es_migration_apis';\nimport { GroupByOption, LevelFilterOption } from '../../../types';\n\nimport { DeprecationCountSummary } from './count_summary';\nimport { DeprecationHealth } from './health';\nimport { DeprecationList } from './list';\n\n// exported only for testing\nexport const filterDeps = (level: LevelFilterOption, search: string = '') => {\n  const conditions: Array<(dep: EnrichedDeprecationInfo) => boolean> = [];\n\n  if (level !== LevelFilterOption.all) {\n    conditions.push((dep: DeprecationInfo) => dep.level === level);\n  }\n\n  if (search.length > 0) {\n    // Change everything to lower case for a case-insensitive comparison\n    conditions.push(dep => {\n      try {\n        const searchReg = new RegExp(search.toLowerCase());\n        return Boolean(\n          dep.message.toLowerCase().match(searchReg) ||\n            (dep.details && dep.details.toLowerCase().match(searchReg)) ||\n            (dep.index && dep.index.toLowerCase().match(searchReg)) ||\n            (dep.node && dep.node.toLowerCase().match(searchReg))\n        );\n      } catch (e) {\n        // ignore any regexp errors.\n        return true;\n      }\n    });\n  }\n\n  // Return true if every condition function returns true (boolean AND)\n  return (dep: EnrichedDeprecationInfo) => conditions.map(c => c(dep)).every(t => t);\n};\n\n/**\n * A single accordion item for a grouped deprecation item.\n */\nexport const DeprecationAccordion: StatelessComponent<{\n  id: string;\n  deprecations: EnrichedDeprecationInfo[];\n  title: string;\n  currentGroupBy: GroupByOption;\n  forceExpand: boolean;\n}> = ({ id, deprecations, title, currentGroupBy, forceExpand }) => {\n  const hasIndices = Boolean(\n    currentGroupBy === GroupByOption.message && deprecations.filter(d => d.index).length\n  );\n  const numIndices = hasIndices ? deprecations.length : null;\n\n  return (\n    <EuiAccordion\n      id={id}\n      className=\"upgDeprecations__item\"\n      initialIsOpen={forceExpand}\n      buttonContent={<span className=\"upgDeprecations__itemName\">{title}</span>}\n      extraAction={\n        <div>\n          {hasIndices && (\n            <Fragment>\n              <EuiBadge color=\"hollow\">\n                <span data-test-subj=\"indexCount\">{numIndices}</span>{' '}\n                <FormattedMessage\n                  id=\"xpack.upgradeAssistant.checkupTab.indicesBadgeLabel\"\n                  defaultMessage=\"{numIndices, plural, one {index} other {indices}}\"\n                  values={{ numIndices }}\n                />\n              </EuiBadge>\n              &emsp;\n            </Fragment>\n          )}\n          <DeprecationHealth\n            single={currentGroupBy === GroupByOption.message}\n            deprecations={deprecations}\n          />\n        </div>\n      }\n    >\n      <DeprecationList deprecations={deprecations} currentGroupBy={currentGroupBy} />\n    </EuiAccordion>\n  );\n};\n\ninterface GroupedDeprecationsProps {\n  currentFilter: LevelFilterOption;\n  search: string;\n  currentGroupBy: GroupByOption;\n  allDeprecations?: EnrichedDeprecationInfo[];\n}\n\ninterface GroupedDeprecationsState {\n  forceExpand: true | false | null;\n  expandNumber: number;\n  currentPage: number;\n}\n\nconst PER_PAGE = 25;\n\n/**\n * Collection of calculated fields based on props, extracted for reuse in\n * `render` and `getDerivedStateFromProps`.\n */\nconst CalcFields = {\n  filteredDeprecations(props: GroupedDeprecationsProps) {\n    const { allDeprecations = [], currentFilter, search } = props;\n    return allDeprecations.filter(filterDeps(currentFilter, search));\n  },\n\n  groups(props: GroupedDeprecationsProps) {\n    const { currentGroupBy } = props;\n    return groupBy(CalcFields.filteredDeprecations(props), currentGroupBy);\n  },\n\n  numPages(props: GroupedDeprecationsProps) {\n    return Math.ceil(Object.keys(CalcFields.groups(props)).length / PER_PAGE);\n  },\n};\n\n/**\n * Displays groups of deprecation messages in an accordion.\n */\nexport class GroupedDeprecations extends React.Component<\n  GroupedDeprecationsProps,\n  GroupedDeprecationsState\n> {\n  public static getDerivedStateFromProps(\n    nextProps: GroupedDeprecationsProps,\n    { currentPage }: GroupedDeprecationsState\n  ) {\n    // If filters change and the currentPage is now bigger than the num of pages we're going to show,\n    // reset the current page to 0.\n    if (currentPage >= CalcFields.numPages(nextProps)) {\n      return { currentPage: 0 };\n    } else {\n      return null;\n    }\n  }\n\n  public state = {\n    forceExpand: false,\n    // `expandNumber` is used as workaround to force EuiAccordion to re-render by\n    // incrementing this number (used as a key) when expand all or collapse all is clicked.\n    expandNumber: 0,\n    currentPage: 0,\n  };\n\n  public render() {\n    const { currentGroupBy, allDeprecations = [] } = this.props;\n    const { forceExpand, expandNumber, currentPage } = this.state;\n\n    const filteredDeprecations = CalcFields.filteredDeprecations(this.props);\n    const groups = CalcFields.groups(this.props);\n\n    return (\n      <Fragment>\n        <EuiFlexGroup responsive={false} alignItems=\"center\">\n          <EuiFlexItem grow={false}>\n            <EuiButtonEmpty\n              flush=\"left\"\n              size=\"s\"\n              onClick={() => this.setExpand(true)}\n              data-test-subj=\"expandAll\"\n            >\n              <FormattedMessage\n                id=\"xpack.upgradeAssistant.checkupTab.controls.expandAllButtonLabel\"\n                defaultMessage=\"Expand all\"\n              />\n            </EuiButtonEmpty>\n          </EuiFlexItem>\n          <EuiFlexItem grow={false}>\n            <EuiButtonEmpty\n              flush=\"left\"\n              size=\"s\"\n              onClick={() => this.setExpand(false)}\n              data-test-subj=\"collapseAll\"\n            >\n              <FormattedMessage\n                id=\"xpack.upgradeAssistant.checkupTab.controls.collapseAllButtonLabel\"\n                defaultMessage=\"Collapse all\"\n              />\n            </EuiButtonEmpty>\n          </EuiFlexItem>\n          <EuiFlexItem />\n          <EuiFlexItem grow={false}>\n            <DeprecationCountSummary\n              allDeprecations={allDeprecations}\n              deprecations={filteredDeprecations}\n            />\n          </EuiFlexItem>\n        </EuiFlexGroup>\n\n        <EuiSpacer size=\"s\" />\n\n        <div className=\"upgDeprecations\">\n          {Object.keys(groups)\n            .sort()\n            // Apply pagination\n            .slice(currentPage * PER_PAGE, (currentPage + 1) * PER_PAGE)\n            .map(groupName => [\n              <DeprecationAccordion\n                key={expandNumber}\n                id={`depgroup-${groupName}`}\n                title={groupName}\n                deprecations={groups[groupName]}\n                {...{ currentGroupBy, forceExpand }}\n              />,\n            ])}\n\n          {/* Only show pagination if we have more than PER_PAGE. */}\n          {Object.keys(groups).length > PER_PAGE && (\n            <Fragment>\n              <EuiSpacer />\n\n              <EuiFlexGroup justifyContent=\"spaceAround\">\n                <EuiFlexItem grow={false}>\n                  <EuiPagination\n                    pageCount={CalcFields.numPages(this.props)}\n                    activePage={currentPage}\n                    onPageClick={this.setPage}\n                  />\n                </EuiFlexItem>\n              </EuiFlexGroup>\n            </Fragment>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n\n  private setExpand = (forceExpand: boolean) => {\n    this.setState({ forceExpand, expandNumber: this.state.expandNumber + 1 });\n  };\n\n  private setPage = (currentPage: number) => this.setState({ currentPage });\n}\n"]}]}