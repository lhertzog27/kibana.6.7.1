{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/tag/create.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/tag/create.tsx","mtime":1567631711883},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { EuiButton, EuiButtonEmpty, EuiFlexGroup, EuiFlexItem, EuiSpacer } from '@elastic/eui';\nimport euiVars from '@elastic/eui/dist/eui_theme_k6_light.json';\nimport { i18n } from '@kbn/i18n';\nimport { FormattedMessage, injectI18n } from '@kbn/i18n/react';\nimport 'brace/mode/yaml';\nimport 'brace/theme/github';\nimport { isEqual } from 'lodash';\nimport React from 'react';\nimport { UNIQUENESS_ENFORCING_TYPES } from '../../../common/constants/configuration_blocks';\nimport { PrimaryLayout } from '../../components/layouts/primary';\nimport { TagEdit } from '../../components/tag';\nimport { randomEUIColor } from '../../utils/random_eui_color';\nvar TagCreatePageComponent = /** @class */ (function (_super) {\n    tslib_1.__extends(TagCreatePageComponent, _super);\n    function TagCreatePageComponent(props) {\n        var _this = _super.call(this, props) || this;\n        _this.saveTag = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var newTag, createBlocksResponse, creationError;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.props.containers.tags.upsertTag(this.state.tag)];\n                    case 1:\n                        newTag = _a.sent();\n                        if (!newTag) {\n                            return [2 /*return*/, alert(i18n.translate('xpack.beatsManagement.createTag.errorSavingTagTitle', {\n                                    defaultMessage: 'error saving tag',\n                                }))];\n                        }\n                        return [4 /*yield*/, this.props.libs.configBlocks.upsert(this.state.configuration_blocks.map(function (block) { return (tslib_1.__assign({}, block, { tag: _this.state.tag.id })); }))];\n                    case 2:\n                        createBlocksResponse = _a.sent();\n                        creationError = createBlocksResponse.reduce(function (err, resp) { return (!err ? (err = resp.error || '') : err); }, '');\n                        if (creationError) {\n                            return [2 /*return*/, alert(creationError)];\n                        }\n                        this.props.goTo(\"/overview/configuration_tags\");\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.getNumExclusiveConfigurationBlocks = function () {\n            return _this.state.configuration_blocks\n                .map(function (_a) {\n                var type = _a.type;\n                return UNIQUENESS_ENFORCING_TYPES.some(function (uniqueType) { return uniqueType === type; });\n            })\n                .reduce(function (acc, cur) { return (cur ? acc + 1 : acc); }, 0);\n        };\n        _this.state = {\n            showFlyout: false,\n            currentConfigPage: 0,\n            tag: {\n                id: '',\n                name: '',\n                color: randomEUIColor(euiVars),\n                hasConfigurationBlocksTypes: [],\n            },\n            configuration_blocks: [],\n        };\n        return _this;\n    }\n    TagCreatePageComponent.prototype.render = function () {\n        var _this = this;\n        var intl = this.props.intl;\n        var blockStartingIndex = this.state.currentConfigPage * 5;\n        return (React.createElement(PrimaryLayout, { hideBreadcrumbs: this.props.libs.framework.versionGreaterThen('6.7.0'), title: intl.formatMessage({\n                id: 'xpack.beatsManagement.tag.createTagTitle',\n                defaultMessage: 'Create Tag',\n            }) },\n            React.createElement(\"div\", null,\n                React.createElement(TagEdit, { tag: this.state.tag, configuration_blocks: {\n                        blocks: this.state.configuration_blocks.slice(blockStartingIndex, 5 + blockStartingIndex),\n                        page: this.state.currentConfigPage,\n                        total: this.state.configuration_blocks.length,\n                    }, onTagChange: function (field, value) {\n                        return _this.setState(function (oldState) {\n                            var _a;\n                            return ({\n                                tag: tslib_1.__assign({}, oldState.tag, (_a = {}, _a[field] = value, _a)),\n                            });\n                        });\n                    }, onConfigListChange: function (index) {\n                        _this.setState({\n                            currentConfigPage: index,\n                        });\n                    }, onConfigAddOrEdit: function (block) {\n                        _this.setState(function (previousState) { return ({\n                            configuration_blocks: previousState.configuration_blocks.concat([block]),\n                        }); });\n                    }, onConfigRemoved: function (block) {\n                        _this.setState(function (previousState) {\n                            var selectedIndex = previousState.configuration_blocks.findIndex(function (c) {\n                                return isEqual(block, c);\n                            });\n                            var blocks = tslib_1.__spread(previousState.configuration_blocks);\n                            blocks.splice(selectedIndex, 1);\n                            return {\n                                configuration_blocks: blocks,\n                            };\n                        });\n                    } }),\n                React.createElement(EuiSpacer, { size: \"m\" }),\n                React.createElement(EuiFlexGroup, null,\n                    React.createElement(EuiFlexItem, { grow: false },\n                        React.createElement(EuiButton, { fill: true, disabled: this.state.tag.name.search(/^[A-Za-z0-9? ,_-]+$/) === -1 ||\n                                this.state.tag.name === '' ||\n                                this.getNumExclusiveConfigurationBlocks() > 1 // || this.state.tag.configuration_blocks.length === 0\n                            , onClick: this.saveTag },\n                            React.createElement(FormattedMessage, { id: \"xpack.beatsManagement.tag.saveButtonLabel\", defaultMessage: \"Save\" }))),\n                    React.createElement(EuiFlexItem, { grow: false },\n                        React.createElement(EuiButtonEmpty, { onClick: function () { return _this.props.goTo('/overview/configuration_tags'); } },\n                            React.createElement(FormattedMessage, { id: \"xpack.beatsManagement.tag.cancelButtonLabel\", defaultMessage: \"Cancel\" })))))));\n    };\n    return TagCreatePageComponent;\n}(React.PureComponent));\nexport var TagCreatePage = injectI18n(TagCreatePageComponent);\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/tag/create.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/tag/create.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport { EuiButton, EuiButtonEmpty, EuiFlexGroup, EuiFlexItem, EuiSpacer } from '@elastic/eui';\nimport euiVars from '@elastic/eui/dist/eui_theme_k6_light.json';\nimport { i18n } from '@kbn/i18n';\nimport { FormattedMessage, InjectedIntl, injectI18n } from '@kbn/i18n/react';\nimport 'brace/mode/yaml';\nimport 'brace/theme/github';\nimport { isEqual } from 'lodash';\nimport React from 'react';\nimport { UNIQUENESS_ENFORCING_TYPES } from '../../../common/constants/configuration_blocks';\nimport { BeatTag, ConfigurationBlock } from '../../../common/domain_types';\nimport { PrimaryLayout } from '../../components/layouts/primary';\nimport { TagEdit } from '../../components/tag';\nimport { AppPageProps } from '../../frontend_types';\nimport { randomEUIColor } from '../../utils/random_eui_color';\n\ninterface TagPageState {\n  showFlyout: boolean;\n  tag: BeatTag;\n  configuration_blocks: ConfigurationBlock[];\n  currentConfigPage: number;\n}\nclass TagCreatePageComponent extends React.PureComponent<\n  AppPageProps & {\n    intl: InjectedIntl;\n  },\n  TagPageState\n> {\n  constructor(props: AppPageProps & { intl: InjectedIntl }) {\n    super(props);\n\n    this.state = {\n      showFlyout: false,\n      currentConfigPage: 0,\n      tag: {\n        id: '',\n        name: '',\n        color: randomEUIColor(euiVars),\n        hasConfigurationBlocksTypes: [],\n      },\n      configuration_blocks: [],\n    };\n  }\n  public render() {\n    const { intl } = this.props;\n    const blockStartingIndex = this.state.currentConfigPage * 5;\n    return (\n      <PrimaryLayout\n        hideBreadcrumbs={this.props.libs.framework.versionGreaterThen('6.7.0')}\n        title={intl.formatMessage({\n          id: 'xpack.beatsManagement.tag.createTagTitle',\n          defaultMessage: 'Create Tag',\n        })}\n      >\n        <div>\n          <TagEdit\n            tag={this.state.tag}\n            configuration_blocks={{\n              blocks: this.state.configuration_blocks.slice(\n                blockStartingIndex,\n                5 + blockStartingIndex\n              ),\n              page: this.state.currentConfigPage,\n              total: this.state.configuration_blocks.length,\n            }}\n            onTagChange={(field: string, value: string | number) =>\n              this.setState(oldState => ({\n                tag: { ...oldState.tag, [field]: value },\n              }))\n            }\n            onConfigListChange={(index: number) => {\n              this.setState({\n                currentConfigPage: index,\n              });\n            }}\n            onConfigAddOrEdit={(block: ConfigurationBlock) => {\n              this.setState(previousState => ({\n                configuration_blocks: previousState.configuration_blocks.concat([block]),\n              }));\n            }}\n            onConfigRemoved={(block: ConfigurationBlock) => {\n              this.setState(previousState => {\n                const selectedIndex = previousState.configuration_blocks.findIndex(c => {\n                  return isEqual(block, c);\n                });\n                const blocks = [...previousState.configuration_blocks];\n                blocks.splice(selectedIndex, 1);\n                return {\n                  configuration_blocks: blocks,\n                };\n              });\n            }}\n          />\n          <EuiSpacer size=\"m\" />\n          <EuiFlexGroup>\n            <EuiFlexItem grow={false}>\n              <EuiButton\n                fill\n                disabled={\n                  this.state.tag.name.search(/^[A-Za-z0-9? ,_-]+$/) === -1 ||\n                  this.state.tag.name === '' ||\n                  this.getNumExclusiveConfigurationBlocks() > 1 // || this.state.tag.configuration_blocks.length === 0\n                }\n                onClick={this.saveTag}\n              >\n                <FormattedMessage\n                  id=\"xpack.beatsManagement.tag.saveButtonLabel\"\n                  defaultMessage=\"Save\"\n                />\n              </EuiButton>\n            </EuiFlexItem>\n            <EuiFlexItem grow={false}>\n              <EuiButtonEmpty onClick={() => this.props.goTo('/overview/configuration_tags')}>\n                <FormattedMessage\n                  id=\"xpack.beatsManagement.tag.cancelButtonLabel\"\n                  defaultMessage=\"Cancel\"\n                />\n              </EuiButtonEmpty>\n            </EuiFlexItem>\n          </EuiFlexGroup>\n        </div>\n      </PrimaryLayout>\n    );\n  }\n\n  private saveTag = async () => {\n    const newTag = await this.props.containers.tags.upsertTag(this.state.tag);\n    if (!newTag) {\n      return alert(\n        i18n.translate('xpack.beatsManagement.createTag.errorSavingTagTitle', {\n          defaultMessage: 'error saving tag',\n        })\n      );\n    }\n    const createBlocksResponse = await this.props.libs.configBlocks.upsert(\n      this.state.configuration_blocks.map(block => ({ ...block, tag: this.state.tag.id }))\n    );\n    const creationError = createBlocksResponse.reduce(\n      (err: string, resp: any) => (!err ? (err = resp.error || '') : err),\n      ''\n    );\n    if (creationError) {\n      return alert(creationError);\n    }\n\n    this.props.goTo(`/overview/configuration_tags`);\n  };\n  private getNumExclusiveConfigurationBlocks = () =>\n    this.state.configuration_blocks\n      .map(({ type }) => UNIQUENESS_ENFORCING_TYPES.some(uniqueType => uniqueType === type))\n      .reduce((acc, cur) => (cur ? acc + 1 : acc), 0);\n}\n\nexport const TagCreatePage = injectI18n(TagCreatePageComponent);\n"]}]}