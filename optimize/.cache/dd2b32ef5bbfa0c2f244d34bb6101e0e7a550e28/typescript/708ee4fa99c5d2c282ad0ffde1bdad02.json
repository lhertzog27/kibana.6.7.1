{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/TransactionDetails/Transaction/WaterfallContainer/Waterfall/index.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/TransactionDetails/Transaction/WaterfallContainer/Waterfall/index.tsx","mtime":1567631711862},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport React, { Component } from 'react';\n// @ts-ignore\nimport { StickyContainer } from 'react-sticky';\nimport styled from 'styled-components';\nimport { fromQuery, history, toQuery } from 'x-pack/plugins/apm/public/components/shared/Links/url_helpers';\n// @ts-ignore\nimport Timeline from '../../../../../shared/charts/Timeline';\nimport { SpanFlyout } from './SpanFlyout';\nimport { TransactionFlyout } from './TransactionFlyout';\nimport { WaterfallItem } from './WaterfallItem';\nvar Container = styled.div(templateObject_1 || (templateObject_1 = tslib_1.__makeTemplateObject([\"\\n  transition: 0.1s padding ease;\\n  position: relative;\\n  overflow: hidden;\\n\"], [\"\\n  transition: 0.1s padding ease;\\n  position: relative;\\n  overflow: hidden;\\n\"])));\nvar TIMELINE_MARGINS = {\n    top: 40,\n    left: 50,\n    right: 50,\n    bottom: 0\n};\nvar Waterfall = /** @class */ (function (_super) {\n    tslib_1.__extends(Waterfall, _super);\n    function Waterfall() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.onOpenFlyout = function (item) {\n            _this.setQueryParams({\n                flyoutDetailTab: undefined,\n                waterfallItemId: String(item.id)\n            });\n        };\n        _this.onCloseFlyout = function () {\n            _this.setQueryParams({\n                flyoutDetailTab: undefined,\n                waterfallItemId: undefined\n            });\n        };\n        _this.getWaterfallItem = function (item) {\n            var _a = _this.props, serviceColors = _a.serviceColors, waterfall = _a.waterfall, urlParams = _a.urlParams;\n            return (React.createElement(WaterfallItem, { key: item.id, timelineMargins: TIMELINE_MARGINS, color: serviceColors[item.serviceName], item: item, totalDuration: waterfall.duration, isSelected: item.id === urlParams.waterfallItemId, onClick: function () { return _this.onOpenFlyout(item); } }));\n        };\n        _this.getFlyOut = function () {\n            var _a = _this.props, waterfall = _a.waterfall, location = _a.location, urlParams = _a.urlParams;\n            var currentItem = urlParams.waterfallItemId &&\n                waterfall.itemsById[urlParams.waterfallItemId];\n            if (!currentItem) {\n                return null;\n            }\n            switch (currentItem.docType) {\n                case 'span':\n                    var parentTransaction = waterfall.getTransactionById(currentItem.parentId);\n                    return (React.createElement(SpanFlyout, { totalDuration: waterfall.duration, span: currentItem.span, parentTransaction: parentTransaction, onClose: _this.onCloseFlyout }));\n                case 'transaction':\n                    return (React.createElement(TransactionFlyout, { transaction: currentItem.transaction, onClose: _this.onCloseFlyout, location: location, urlParams: urlParams, waterfall: waterfall }));\n                default:\n                    return null;\n            }\n        };\n        return _this;\n    }\n    Waterfall.prototype.render = function () {\n        var waterfall = this.props.waterfall;\n        var itemContainerHeight = 58; // TODO: This is a nasty way to calculate the height of the svg element. A better approach should be found\n        var waterfallHeight = itemContainerHeight * waterfall.items.length;\n        return (React.createElement(Container, null,\n            React.createElement(StickyContainer, null,\n                React.createElement(Timeline, { agentMarks: this.props.agentMarks, duration: waterfall.duration, traceRootDuration: waterfall.traceRootDuration, height: waterfallHeight, margins: TIMELINE_MARGINS }),\n                React.createElement(\"div\", { style: {\n                        paddingTop: TIMELINE_MARGINS.top\n                    } }, waterfall.items.map(this.getWaterfallItem))),\n            this.getFlyOut()));\n    };\n    Waterfall.prototype.setQueryParams = function (params) {\n        var location = this.props.location;\n        history.replace(tslib_1.__assign({}, location, { search: fromQuery(tslib_1.__assign({}, toQuery(location.search), params)) }));\n    };\n    return Waterfall;\n}(Component));\nexport { Waterfall };\nvar templateObject_1;\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/TransactionDetails/Transaction/WaterfallContainer/Waterfall/index.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/TransactionDetails/Transaction/WaterfallContainer/Waterfall/index.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport { Location } from 'history';\nimport React, { Component } from 'react';\n// @ts-ignore\nimport { StickyContainer } from 'react-sticky';\nimport styled from 'styled-components';\nimport {\n  fromQuery,\n  history,\n  QueryParams,\n  toQuery\n} from 'x-pack/plugins/apm/public/components/shared/Links/url_helpers';\nimport { IUrlParams } from '../../../../../../store/urlParams';\n// @ts-ignore\nimport Timeline from '../../../../../shared/charts/Timeline';\nimport { AgentMark } from '../get_agent_marks';\nimport { SpanFlyout } from './SpanFlyout';\nimport { TransactionFlyout } from './TransactionFlyout';\nimport {\n  IServiceColors,\n  IWaterfall,\n  IWaterfallItem\n} from './waterfall_helpers/waterfall_helpers';\nimport { WaterfallItem } from './WaterfallItem';\n\nconst Container = styled.div`\n  transition: 0.1s padding ease;\n  position: relative;\n  overflow: hidden;\n`;\n\nconst TIMELINE_MARGINS = {\n  top: 40,\n  left: 50,\n  right: 50,\n  bottom: 0\n};\n\ninterface Props {\n  agentMarks: AgentMark[];\n  urlParams: IUrlParams;\n  waterfall: IWaterfall;\n  location: Location;\n  serviceColors: IServiceColors;\n}\n\nexport class Waterfall extends Component<Props> {\n  public onOpenFlyout = (item: IWaterfallItem) => {\n    this.setQueryParams({\n      flyoutDetailTab: undefined,\n      waterfallItemId: String(item.id)\n    });\n  };\n\n  public onCloseFlyout = () => {\n    this.setQueryParams({\n      flyoutDetailTab: undefined,\n      waterfallItemId: undefined\n    });\n  };\n\n  public getWaterfallItem = (item: IWaterfallItem) => {\n    const { serviceColors, waterfall, urlParams }: Props = this.props;\n\n    return (\n      <WaterfallItem\n        key={item.id}\n        timelineMargins={TIMELINE_MARGINS}\n        color={serviceColors[item.serviceName]}\n        item={item}\n        totalDuration={waterfall.duration}\n        isSelected={item.id === urlParams.waterfallItemId}\n        onClick={() => this.onOpenFlyout(item)}\n      />\n    );\n  };\n\n  public getFlyOut = () => {\n    const { waterfall, location, urlParams } = this.props;\n\n    const currentItem =\n      urlParams.waterfallItemId &&\n      waterfall.itemsById[urlParams.waterfallItemId];\n\n    if (!currentItem) {\n      return null;\n    }\n\n    switch (currentItem.docType) {\n      case 'span':\n        const parentTransaction = waterfall.getTransactionById(\n          currentItem.parentId\n        );\n\n        return (\n          <SpanFlyout\n            totalDuration={waterfall.duration}\n            span={currentItem.span}\n            parentTransaction={parentTransaction}\n            onClose={this.onCloseFlyout}\n          />\n        );\n      case 'transaction':\n        return (\n          <TransactionFlyout\n            transaction={currentItem.transaction}\n            onClose={this.onCloseFlyout}\n            location={location}\n            urlParams={urlParams}\n            waterfall={waterfall}\n          />\n        );\n      default:\n        return null;\n    }\n  };\n\n  public render() {\n    const { waterfall } = this.props;\n    const itemContainerHeight = 58; // TODO: This is a nasty way to calculate the height of the svg element. A better approach should be found\n    const waterfallHeight = itemContainerHeight * waterfall.items.length;\n\n    return (\n      <Container>\n        <StickyContainer>\n          <Timeline\n            agentMarks={this.props.agentMarks}\n            duration={waterfall.duration}\n            traceRootDuration={waterfall.traceRootDuration}\n            height={waterfallHeight}\n            margins={TIMELINE_MARGINS}\n          />\n          <div\n            style={{\n              paddingTop: TIMELINE_MARGINS.top\n            }}\n          >\n            {waterfall.items.map(this.getWaterfallItem)}\n          </div>\n        </StickyContainer>\n\n        {this.getFlyOut()}\n      </Container>\n    );\n  }\n\n  private setQueryParams(params: QueryParams) {\n    const { location } = this.props;\n    history.replace({\n      ...location,\n      search: fromQuery({\n        ...toQuery(location.search),\n        ...params\n      })\n    });\n  }\n}\n"]}]}