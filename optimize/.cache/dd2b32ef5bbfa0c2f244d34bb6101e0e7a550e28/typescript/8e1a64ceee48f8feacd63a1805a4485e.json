{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/walkthrough/initial/tag.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/walkthrough/initial/tag.tsx","mtime":1567631711884},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["import * as tslib_1 from \"tslib\";\n/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport { EuiButton, EuiFlexGroup, EuiFlexItem } from '@elastic/eui';\nimport { i18n } from '@kbn/i18n';\nimport { FormattedMessage } from '@kbn/i18n/react';\nimport { isEqual } from 'lodash';\nimport React, { Component } from 'react';\nimport uuidv4 from 'uuid/v4';\nimport { TagEdit } from '../../../components/tag/tag_edit';\nvar InitialTagPage = /** @class */ (function (_super) {\n    tslib_1.__extends(InitialTagPage, _super);\n    function InitialTagPage(props) {\n        var _this = _super.call(this, props) || this;\n        _this.loadTag = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var tags;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.props.libs.tags.getTagsWithIds([this.state.tag.id])];\n                    case 1:\n                        tags = _a.sent();\n                        if (tags.length > 0) {\n                            this.setState({\n                                tag: tags[0],\n                            });\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.saveTag = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var newTag, createBlocksResponse, creationError;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.props.libs.tags.upsertTag(this.state.tag)];\n                    case 1:\n                        newTag = _a.sent();\n                        if (!newTag) {\n                            return [2 /*return*/, alert(i18n.translate('xpack.beatsManagement.createTag.errorSavingTagTitle', {\n                                    defaultMessage: 'error saving tag',\n                                }))];\n                        }\n                        return [4 /*yield*/, this.props.libs.configBlocks.upsert(this.state.configuration_blocks.map(function (block) { return (tslib_1.__assign({}, block, { tag: _this.state.tag.id })); }))];\n                    case 2:\n                        createBlocksResponse = _a.sent();\n                        creationError = createBlocksResponse.reduce(function (err, resp) { return (!err ? (err = resp.error || '') : err); }, '');\n                        if (creationError) {\n                            return [2 /*return*/, alert(creationError)];\n                        }\n                        this.props.setUrlState({\n                            createdTag: newTag.id,\n                        });\n                        this.props.goTo(\"/walkthrough/initial/finish\");\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.state = {\n            tag: {\n                id: uuidv4(),\n                name: '',\n                color: '#DD0A73',\n                hasConfigurationBlocksTypes: [],\n            },\n            configuration_blocks: [],\n            currentConfigPage: 0,\n        };\n        if (props.urlState.createdTag) {\n            _this.loadTag();\n        }\n        return _this;\n    }\n    InitialTagPage.prototype.render = function () {\n        var _this = this;\n        var blockStartingIndex = this.state.currentConfigPage * 5;\n        return (React.createElement(React.Fragment, null,\n            React.createElement(TagEdit, { tag: this.state.tag, configuration_blocks: {\n                    blocks: this.state.configuration_blocks.slice(blockStartingIndex, 5 + blockStartingIndex),\n                    page: this.state.currentConfigPage,\n                    total: this.state.configuration_blocks.length,\n                }, onTagChange: function (field, value) {\n                    return _this.setState(function (oldState) {\n                        var _a;\n                        return ({\n                            tag: tslib_1.__assign({}, oldState.tag, (_a = {}, _a[field] = value, _a)),\n                        });\n                    });\n                }, onConfigListChange: function (index) {\n                    _this.setState({\n                        currentConfigPage: index,\n                    });\n                }, onConfigAddOrEdit: function (block) {\n                    _this.setState(function (previousState) { return ({\n                        configuration_blocks: previousState.configuration_blocks.concat([block]),\n                    }); });\n                }, onConfigRemoved: function (block) {\n                    _this.setState(function (previousState) {\n                        var selectedIndex = previousState.configuration_blocks.findIndex(function (c) {\n                            return isEqual(block, c);\n                        });\n                        var blocks = tslib_1.__spread(previousState.configuration_blocks);\n                        blocks.splice(selectedIndex, 1);\n                        return {\n                            configuration_blocks: blocks,\n                        };\n                    });\n                } }),\n            React.createElement(EuiFlexGroup, null,\n                React.createElement(EuiFlexItem, { grow: false },\n                    React.createElement(EuiButton, { fill: true, disabled: this.state.tag.name.search(/^[A-Za-z0-9? ,_-]+$/) === -1 ||\n                            this.state.tag.name === '' ||\n                            this.state.configuration_blocks.length === 0, onClick: this.saveTag },\n                        React.createElement(FormattedMessage, { id: \"xpack.beatsManagement.createTag.saveAndContinueButtonLabel\", defaultMessage: \"Save & Continue\" }))))));\n    };\n    return InitialTagPage;\n}(Component));\nexport { InitialTagPage };\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/walkthrough/initial/tag.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/pages/walkthrough/initial/tag.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport { EuiButton, EuiFlexGroup, EuiFlexItem } from '@elastic/eui';\nimport { i18n } from '@kbn/i18n';\nimport { FormattedMessage } from '@kbn/i18n/react';\nimport { isEqual } from 'lodash';\nimport React, { Component } from 'react';\nimport uuidv4 from 'uuid/v4';\nimport { BeatTag, ConfigurationBlock } from '../../../../common/domain_types';\nimport { TagEdit } from '../../../components/tag/tag_edit';\nimport { AppPageProps } from '../../../frontend_types';\ninterface PageState {\n  tag: BeatTag;\n  configuration_blocks: ConfigurationBlock[];\n  currentConfigPage: number;\n}\n\nexport class InitialTagPage extends Component<AppPageProps, PageState> {\n  constructor(props: AppPageProps) {\n    super(props);\n    this.state = {\n      tag: {\n        id: uuidv4(),\n        name: '',\n        color: '#DD0A73',\n        hasConfigurationBlocksTypes: [],\n      },\n      configuration_blocks: [],\n      currentConfigPage: 0,\n    };\n\n    if (props.urlState.createdTag) {\n      this.loadTag();\n    }\n  }\n\n  public render() {\n    const blockStartingIndex = this.state.currentConfigPage * 5;\n\n    return (\n      <React.Fragment>\n        <TagEdit\n          tag={this.state.tag}\n          configuration_blocks={{\n            blocks: this.state.configuration_blocks.slice(\n              blockStartingIndex,\n              5 + blockStartingIndex\n            ),\n            page: this.state.currentConfigPage,\n            total: this.state.configuration_blocks.length,\n          }}\n          onTagChange={(field: string, value: string | number) =>\n            this.setState(oldState => ({\n              tag: { ...oldState.tag, [field]: value },\n            }))\n          }\n          onConfigListChange={(index: number) => {\n            this.setState({\n              currentConfigPage: index,\n            });\n          }}\n          onConfigAddOrEdit={(block: ConfigurationBlock) => {\n            this.setState(previousState => ({\n              configuration_blocks: previousState.configuration_blocks.concat([block]),\n            }));\n          }}\n          onConfigRemoved={(block: ConfigurationBlock) => {\n            this.setState(previousState => {\n              const selectedIndex = previousState.configuration_blocks.findIndex(c => {\n                return isEqual(block, c);\n              });\n              const blocks = [...previousState.configuration_blocks];\n              blocks.splice(selectedIndex, 1);\n              return {\n                configuration_blocks: blocks,\n              };\n            });\n          }}\n        />\n        <EuiFlexGroup>\n          <EuiFlexItem grow={false}>\n            <EuiButton\n              fill\n              disabled={\n                this.state.tag.name.search(/^[A-Za-z0-9? ,_-]+$/) === -1 ||\n                this.state.tag.name === '' ||\n                this.state.configuration_blocks.length === 0\n              }\n              onClick={this.saveTag}\n            >\n              <FormattedMessage\n                id=\"xpack.beatsManagement.createTag.saveAndContinueButtonLabel\"\n                defaultMessage=\"Save & Continue\"\n              />\n            </EuiButton>\n          </EuiFlexItem>\n        </EuiFlexGroup>\n      </React.Fragment>\n    );\n  }\n\n  private loadTag = async () => {\n    const tags = await this.props.libs.tags.getTagsWithIds([this.state.tag.id]);\n    if (tags.length > 0) {\n      this.setState({\n        tag: tags[0],\n      });\n    }\n  };\n\n  private saveTag = async () => {\n    const newTag = await this.props.libs.tags.upsertTag(this.state.tag as BeatTag);\n    if (!newTag) {\n      return alert(\n        i18n.translate('xpack.beatsManagement.createTag.errorSavingTagTitle', {\n          defaultMessage: 'error saving tag',\n        })\n      );\n    }\n    const createBlocksResponse = await this.props.libs.configBlocks.upsert(\n      this.state.configuration_blocks.map(block => ({ ...block, tag: this.state.tag.id }))\n    );\n    const creationError = createBlocksResponse.reduce(\n      (err: string, resp: any) => (!err ? (err = resp.error || '') : err),\n      ''\n    );\n    if (creationError) {\n      return alert(creationError);\n    }\n    this.props.setUrlState({\n      createdTag: newTag.id,\n    });\n    this.props.goTo(`/walkthrough/initial/finish`);\n  };\n}\n"]}]}