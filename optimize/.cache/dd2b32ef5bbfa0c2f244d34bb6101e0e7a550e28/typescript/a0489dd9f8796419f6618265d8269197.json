{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/ErrorGroupDetails/DetailView/index.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/ErrorGroupDetails/DetailView/index.tsx","mtime":1567631711859},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { EuiButtonEmpty, EuiSpacer, EuiTab, EuiTabs, EuiTitle } from '@elastic/eui';\nimport { i18n } from '@kbn/i18n';\nimport idx from 'idx';\nimport { first, get } from 'lodash';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { ERROR_EXC_STACKTRACE, ERROR_LOG_STACKTRACE } from 'x-pack/plugins/apm/common/constants';\nimport { NOT_AVAILABLE_LABEL } from 'x-pack/plugins/apm/common/i18n';\nimport { KibanaLink } from 'x-pack/plugins/apm/public/components/shared/Links/KibanaLink';\nimport { legacyEncodeURIComponent } from 'x-pack/plugins/apm/public/components/shared/Links/url_helpers';\nimport { fromQuery, history, toQuery } from 'x-pack/plugins/apm/public/components/shared/Links/url_helpers';\nimport { STATUS } from 'x-pack/plugins/apm/public/constants';\nimport { ERROR_EXC_HANDLED, REQUEST_METHOD, REQUEST_URL_FULL, TRACE_ID, TRANSACTION_ID, USER_ID } from '../../../../../common/constants';\nimport { borderRadius, colors, px, unit, units } from '../../../../style/variables';\nimport { DiscoverErrorLink } from '../../../shared/Links/DiscoverLinks/DiscoverErrorLink';\nimport { getPropertyTabNames, PropertiesTable } from '../../../shared/PropertiesTable';\nimport { Stacktrace } from '../../../shared/Stacktrace';\nimport { StickyProperties } from '../../../shared/StickyProperties';\nvar Container = styled.div(templateObject_1 || (templateObject_1 = tslib_1.__makeTemplateObject([\"\\n  position: relative;\\n  border: 1px solid \", \";\\n  border-radius: \", \";\\n  margin-top: \", \";\\n\"], [\"\\n  position: relative;\\n  border: 1px solid \", \";\\n  border-radius: \", \";\\n  margin-top: \", \";\\n\"])), colors.gray4, borderRadius, px(units.plus));\nvar HeaderContainer = styled.div(templateObject_2 || (templateObject_2 = tslib_1.__makeTemplateObject([\"\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: flex-start;\\n  padding: \", \" \", \" 0;\\n  margin-bottom: \", \";\\n\"], [\"\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: flex-start;\\n  padding: \", \" \", \" 0;\\n  margin-bottom: \", \";\\n\"])), px(units.plus), px(units.plus), px(unit));\nvar PaddedContainer = styled.div(templateObject_3 || (templateObject_3 = tslib_1.__makeTemplateObject([\"\\n  padding: \", \" \", \" 0;\\n\"], [\"\\n  padding: \", \" \", \" 0;\\n\"])), px(units.plus), px(units.plus));\nvar logStacktraceTab = {\n    key: 'log_stacktrace',\n    label: i18n.translate('xpack.apm.propertiesTable.tabs.logStacktraceLabel', {\n        defaultMessage: 'Log stacktrace'\n    })\n};\nvar exceptionStacktraceTab = {\n    key: 'exception_stacktrace',\n    label: i18n.translate('xpack.apm.propertiesTable.tabs.exceptionStacktraceLabel', {\n        defaultMessage: 'Exception stacktrace'\n    })\n};\nexport function DetailView(_a) {\n    var errorGroup = _a.errorGroup, urlParams = _a.urlParams, location = _a.location;\n    if (errorGroup.status !== STATUS.SUCCESS) {\n        return null;\n    }\n    var _b = errorGroup.data, transaction = _b.transaction, error = _b.error, occurrencesCount = _b.occurrencesCount;\n    if (!error) {\n        return null;\n    }\n    var transactionLink = getTransactionLink(error, transaction);\n    var stickyProperties = [\n        {\n            fieldName: '@timestamp',\n            label: i18n.translate('xpack.apm.errorGroupDetails.timestampLabel', {\n                defaultMessage: 'Timestamp'\n            }),\n            val: error['@timestamp'],\n            width: '50%'\n        },\n        {\n            fieldName: REQUEST_URL_FULL,\n            label: 'URL',\n            val: idx(error, function (_) { return _.context.page.url; }) ||\n                idx(transaction, function (_) { return _.context.request.url.full; }) ||\n                NOT_AVAILABLE_LABEL,\n            truncated: true,\n            width: '50%'\n        },\n        {\n            fieldName: REQUEST_METHOD,\n            label: i18n.translate('xpack.apm.errorGroupDetails.requestMethodLabel', {\n                defaultMessage: 'Request method'\n            }),\n            val: get(error, REQUEST_METHOD, NOT_AVAILABLE_LABEL),\n            width: '25%'\n        },\n        {\n            fieldName: ERROR_EXC_HANDLED,\n            label: i18n.translate('xpack.apm.errorGroupDetails.handledLabel', {\n                defaultMessage: 'Handled'\n            }),\n            val: String(get(error, ERROR_EXC_HANDLED, NOT_AVAILABLE_LABEL)),\n            width: '25%'\n        },\n        {\n            fieldName: TRANSACTION_ID,\n            label: i18n.translate('xpack.apm.errorGroupDetails.transactionSampleIdLabel', {\n                defaultMessage: 'Transaction sample ID'\n            }),\n            val: transactionLink || NOT_AVAILABLE_LABEL,\n            width: '25%'\n        },\n        {\n            fieldName: USER_ID,\n            label: i18n.translate('xpack.apm.errorGroupDetails.userIdLabel', {\n                defaultMessage: 'User ID'\n            }),\n            val: get(error, USER_ID, NOT_AVAILABLE_LABEL),\n            width: '25%'\n        }\n    ];\n    var tabs = getTabs(error);\n    var currentTab = getCurrentTab(tabs, urlParams.detailTab);\n    return (React.createElement(Container, null,\n        React.createElement(HeaderContainer, null,\n            React.createElement(EuiTitle, { size: \"s\" },\n                React.createElement(\"h3\", null, i18n.translate('xpack.apm.errorGroupDetails.errorOccurrenceTitle', {\n                    defaultMessage: 'Error occurrence'\n                }))),\n            React.createElement(DiscoverErrorLink, { error: error, kuery: urlParams.kuery },\n                React.createElement(EuiButtonEmpty, { iconType: \"discoverApp\" }, i18n.translate('xpack.apm.errorGroupDetails.viewOccurrencesInDiscoverButtonLabel', {\n                    defaultMessage: 'View {occurrencesCount} occurrences in Discover',\n                    values: { occurrencesCount: occurrencesCount }\n                })))),\n        React.createElement(PaddedContainer, null,\n            React.createElement(StickyProperties, { stickyProperties: stickyProperties })),\n        React.createElement(EuiSpacer, null),\n        React.createElement(EuiTabs, null, tabs.map(function (_a) {\n            var key = _a.key, label = _a.label;\n            return (React.createElement(EuiTab, { onClick: function () {\n                    history.replace(tslib_1.__assign({}, location, { search: fromQuery(tslib_1.__assign({}, toQuery(location.search), { detailTab: key })) }));\n                }, isSelected: currentTab.key === key, key: key }, label));\n        })),\n        React.createElement(PaddedContainer, null,\n            React.createElement(TabContent, { error: error, currentTab: currentTab }))));\n}\nfunction getTransactionLink(error, transaction) {\n    if (!transaction || !get(error, 'transaction.sampled')) {\n        return;\n    }\n    var path = \"/\" + transaction.context.service.name + \"/transactions/\" + legacyEncodeURIComponent(transaction.transaction.type) + \"/\" + legacyEncodeURIComponent(transaction.transaction.name);\n    return (React.createElement(KibanaLink, { hash: path, query: {\n            transactionId: transaction.transaction.id,\n            traceId: get(transaction, TRACE_ID)\n        } }, transaction.transaction.id));\n}\nexport function TabContent(_a) {\n    var error = _a.error, currentTab = _a.currentTab;\n    var codeLanguage = error.context.service.name;\n    var agentName = error.context.service.agent.name;\n    var excStackframes = get(error, ERROR_EXC_STACKTRACE);\n    var logStackframes = get(error, ERROR_LOG_STACKTRACE);\n    switch (currentTab.key) {\n        case logStacktraceTab.key:\n            return (React.createElement(Stacktrace, { stackframes: logStackframes, codeLanguage: codeLanguage }));\n        case exceptionStacktraceTab.key:\n            return (React.createElement(Stacktrace, { stackframes: excStackframes, codeLanguage: codeLanguage }));\n        default:\n            var propData = error.context[currentTab.key];\n            return (React.createElement(PropertiesTable, { propData: propData, propKey: currentTab.key, agentName: agentName }));\n    }\n}\n// Ensure the selected tab exists or use the first\nexport function getCurrentTab(tabs, selectedTabKey) {\n    if (tabs === void 0) { tabs = []; }\n    var selectedTab = tabs.find(function (_a) {\n        var key = _a.key;\n        return key === selectedTabKey;\n    });\n    return selectedTab ? selectedTab : first(tabs) || {};\n}\nexport function getTabs(error) {\n    var hasLogStacktrace = get(error, ERROR_LOG_STACKTRACE, []).length > 0;\n    var contextKeys = Object.keys(error.context);\n    return tslib_1.__spread((hasLogStacktrace ? [logStacktraceTab] : []), [\n        exceptionStacktraceTab\n    ], getPropertyTabNames(contextKeys));\n}\nvar templateObject_1, templateObject_2, templateObject_3;\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/ErrorGroupDetails/DetailView/index.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/apm/public/components/app/ErrorGroupDetails/DetailView/index.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport {\n  EuiButtonEmpty,\n  EuiSpacer,\n  EuiTab,\n  EuiTabs,\n  EuiTitle\n} from '@elastic/eui';\nimport { i18n } from '@kbn/i18n';\nimport { Location } from 'history';\nimport idx from 'idx';\nimport { first, get } from 'lodash';\nimport React from 'react';\nimport { RRRRenderResponse } from 'react-redux-request';\nimport styled from 'styled-components';\nimport {\n  ERROR_EXC_STACKTRACE,\n  ERROR_LOG_STACKTRACE\n} from 'x-pack/plugins/apm/common/constants';\nimport { NOT_AVAILABLE_LABEL } from 'x-pack/plugins/apm/common/i18n';\nimport { KibanaLink } from 'x-pack/plugins/apm/public/components/shared/Links/KibanaLink';\nimport { legacyEncodeURIComponent } from 'x-pack/plugins/apm/public/components/shared/Links/url_helpers';\nimport {\n  fromQuery,\n  history,\n  toQuery\n} from 'x-pack/plugins/apm/public/components/shared/Links/url_helpers';\nimport { STATUS } from 'x-pack/plugins/apm/public/constants';\nimport { IUrlParams } from 'x-pack/plugins/apm/public/store/urlParams';\nimport { ErrorGroupAPIResponse } from 'x-pack/plugins/apm/server/lib/errors/get_error_group';\nimport { APMError } from 'x-pack/plugins/apm/typings/es_schemas/Error';\nimport { IStackframe } from 'x-pack/plugins/apm/typings/es_schemas/Stackframe';\nimport { Transaction } from 'x-pack/plugins/apm/typings/es_schemas/Transaction';\nimport {\n  ERROR_EXC_HANDLED,\n  REQUEST_METHOD,\n  REQUEST_URL_FULL,\n  TRACE_ID,\n  TRANSACTION_ID,\n  USER_ID\n} from '../../../../../common/constants';\nimport {\n  borderRadius,\n  colors,\n  px,\n  unit,\n  units\n} from '../../../../style/variables';\nimport { DiscoverErrorLink } from '../../../shared/Links/DiscoverLinks/DiscoverErrorLink';\nimport {\n  getPropertyTabNames,\n  PropertiesTable,\n  Tab\n} from '../../../shared/PropertiesTable';\nimport { Stacktrace } from '../../../shared/Stacktrace';\nimport { StickyProperties } from '../../../shared/StickyProperties';\n\nconst Container = styled.div`\n  position: relative;\n  border: 1px solid ${colors.gray4};\n  border-radius: ${borderRadius};\n  margin-top: ${px(units.plus)};\n`;\n\nconst HeaderContainer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: ${px(units.plus)} ${px(units.plus)} 0;\n  margin-bottom: ${px(unit)};\n`;\n\nconst PaddedContainer = styled.div`\n  padding: ${px(units.plus)} ${px(units.plus)} 0;\n`;\n\nconst logStacktraceTab = {\n  key: 'log_stacktrace',\n  label: i18n.translate('xpack.apm.propertiesTable.tabs.logStacktraceLabel', {\n    defaultMessage: 'Log stacktrace'\n  })\n};\nconst exceptionStacktraceTab = {\n  key: 'exception_stacktrace',\n  label: i18n.translate(\n    'xpack.apm.propertiesTable.tabs.exceptionStacktraceLabel',\n    {\n      defaultMessage: 'Exception stacktrace'\n    }\n  )\n};\n\ninterface Props {\n  errorGroup: RRRRenderResponse<ErrorGroupAPIResponse>;\n  urlParams: IUrlParams;\n  location: Location;\n}\n\nexport function DetailView({ errorGroup, urlParams, location }: Props) {\n  if (errorGroup.status !== STATUS.SUCCESS) {\n    return null;\n  }\n  const { transaction, error, occurrencesCount } = errorGroup.data;\n\n  if (!error) {\n    return null;\n  }\n\n  const transactionLink = getTransactionLink(error, transaction);\n  const stickyProperties = [\n    {\n      fieldName: '@timestamp',\n      label: i18n.translate('xpack.apm.errorGroupDetails.timestampLabel', {\n        defaultMessage: 'Timestamp'\n      }),\n      val: error['@timestamp'],\n      width: '50%'\n    },\n    {\n      fieldName: REQUEST_URL_FULL,\n      label: 'URL',\n      val:\n        idx(error, _ => _.context.page.url) ||\n        idx(transaction, _ => _.context.request.url.full) ||\n        NOT_AVAILABLE_LABEL,\n      truncated: true,\n      width: '50%'\n    },\n    {\n      fieldName: REQUEST_METHOD,\n      label: i18n.translate('xpack.apm.errorGroupDetails.requestMethodLabel', {\n        defaultMessage: 'Request method'\n      }),\n      val: get(error, REQUEST_METHOD, NOT_AVAILABLE_LABEL),\n      width: '25%'\n    },\n    {\n      fieldName: ERROR_EXC_HANDLED,\n      label: i18n.translate('xpack.apm.errorGroupDetails.handledLabel', {\n        defaultMessage: 'Handled'\n      }),\n      val: String(get(error, ERROR_EXC_HANDLED, NOT_AVAILABLE_LABEL)),\n      width: '25%'\n    },\n    {\n      fieldName: TRANSACTION_ID,\n      label: i18n.translate(\n        'xpack.apm.errorGroupDetails.transactionSampleIdLabel',\n        {\n          defaultMessage: 'Transaction sample ID'\n        }\n      ),\n      val: transactionLink || NOT_AVAILABLE_LABEL,\n      width: '25%'\n    },\n    {\n      fieldName: USER_ID,\n      label: i18n.translate('xpack.apm.errorGroupDetails.userIdLabel', {\n        defaultMessage: 'User ID'\n      }),\n      val: get(error, USER_ID, NOT_AVAILABLE_LABEL),\n      width: '25%'\n    }\n  ];\n\n  const tabs = getTabs(error);\n  const currentTab = getCurrentTab(tabs, urlParams.detailTab);\n\n  return (\n    <Container>\n      <HeaderContainer>\n        <EuiTitle size=\"s\">\n          <h3>\n            {i18n.translate(\n              'xpack.apm.errorGroupDetails.errorOccurrenceTitle',\n              {\n                defaultMessage: 'Error occurrence'\n              }\n            )}\n          </h3>\n        </EuiTitle>\n        <DiscoverErrorLink error={error} kuery={urlParams.kuery}>\n          <EuiButtonEmpty iconType=\"discoverApp\">\n            {i18n.translate(\n              'xpack.apm.errorGroupDetails.viewOccurrencesInDiscoverButtonLabel',\n              {\n                defaultMessage:\n                  'View {occurrencesCount} occurrences in Discover',\n                values: { occurrencesCount }\n              }\n            )}\n          </EuiButtonEmpty>\n        </DiscoverErrorLink>\n      </HeaderContainer>\n\n      <PaddedContainer>\n        <StickyProperties stickyProperties={stickyProperties} />\n      </PaddedContainer>\n\n      <EuiSpacer />\n\n      <EuiTabs>\n        {tabs.map(({ key, label }) => {\n          return (\n            <EuiTab\n              onClick={() => {\n                history.replace({\n                  ...location,\n                  search: fromQuery({\n                    ...toQuery(location.search),\n                    detailTab: key\n                  })\n                });\n              }}\n              isSelected={currentTab.key === key}\n              key={key}\n            >\n              {label}\n            </EuiTab>\n          );\n        })}\n      </EuiTabs>\n\n      <PaddedContainer>\n        <TabContent error={error} currentTab={currentTab} />\n      </PaddedContainer>\n    </Container>\n  );\n}\n\nfunction getTransactionLink(error: APMError, transaction?: Transaction) {\n  if (!transaction || !get(error, 'transaction.sampled')) {\n    return;\n  }\n\n  const path = `/${\n    transaction.context.service.name\n  }/transactions/${legacyEncodeURIComponent(\n    transaction.transaction.type\n  )}/${legacyEncodeURIComponent(transaction.transaction.name)}`;\n\n  return (\n    <KibanaLink\n      hash={path}\n      query={{\n        transactionId: transaction.transaction.id,\n        traceId: get(transaction, TRACE_ID)\n      }}\n    >\n      {transaction.transaction.id}\n    </KibanaLink>\n  );\n}\n\ntype MaybeStackframes = IStackframe[] | undefined;\n\nexport function TabContent({\n  error,\n  currentTab\n}: {\n  error: APMError;\n  currentTab: Tab;\n}) {\n  const codeLanguage = error.context.service.name;\n  const agentName = error.context.service.agent.name;\n  const excStackframes: MaybeStackframes = get(error, ERROR_EXC_STACKTRACE);\n  const logStackframes: MaybeStackframes = get(error, ERROR_LOG_STACKTRACE);\n\n  switch (currentTab.key) {\n    case logStacktraceTab.key:\n      return (\n        <Stacktrace stackframes={logStackframes} codeLanguage={codeLanguage} />\n      );\n    case exceptionStacktraceTab.key:\n      return (\n        <Stacktrace stackframes={excStackframes} codeLanguage={codeLanguage} />\n      );\n    default:\n      const propData = error.context[currentTab.key] as any;\n      return (\n        <PropertiesTable\n          propData={propData}\n          propKey={currentTab.key}\n          agentName={agentName}\n        />\n      );\n  }\n}\n\n// Ensure the selected tab exists or use the first\nexport function getCurrentTab(tabs: Tab[] = [], selectedTabKey?: string) {\n  const selectedTab = tabs.find(({ key }) => key === selectedTabKey);\n  return selectedTab ? selectedTab : first(tabs) || {};\n}\n\nexport function getTabs(error: APMError) {\n  const hasLogStacktrace = get(error, ERROR_LOG_STACKTRACE, []).length > 0;\n  const contextKeys = Object.keys(error.context);\n\n  return [\n    ...(hasLogStacktrace ? [logStacktraceTab] : []),\n    exceptionStacktraceTab,\n    ...getPropertyTabNames(contextKeys)\n  ];\n}\n"]}]}