{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/containers/with_kuery_autocompletion.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/containers/with_kuery_autocompletion.tsx","mtime":1567631711881},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport React from 'react';\nvar WithKueryAutocompletion = /** @class */ (function (_super) {\n    tslib_1.__extends(WithKueryAutocompletion, _super);\n    function WithKueryAutocompletion() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            currentRequest: null,\n            suggestions: [],\n        };\n        _this.loadSuggestions = function (expression, cursorPosition, maxSuggestions) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var suggestions, e_1;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.setState({\n                            currentRequest: {\n                                expression: expression,\n                                cursorPosition: cursorPosition,\n                            },\n                            suggestions: [],\n                        });\n                        suggestions = [];\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.props.libs.elasticsearch.getSuggestions(expression, cursorPosition, this.props.fieldPrefix)];\n                    case 2:\n                        suggestions = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        suggestions = [];\n                        return [3 /*break*/, 4];\n                    case 4:\n                        this.setState(function (state) {\n                            return state.currentRequest &&\n                                state.currentRequest.expression !== expression &&\n                                state.currentRequest.cursorPosition !== cursorPosition\n                                ? state // ignore this result, since a newer request is in flight\n                                : tslib_1.__assign({}, state, { currentRequest: null, suggestions: maxSuggestions ? suggestions.slice(0, maxSuggestions) : suggestions });\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        return _this;\n    }\n    WithKueryAutocompletion.prototype.render = function () {\n        var _a = this.state, currentRequest = _a.currentRequest, suggestions = _a.suggestions;\n        return this.props.children({\n            isLoadingSuggestions: currentRequest !== null,\n            loadSuggestions: this.loadSuggestions,\n            suggestions: suggestions,\n        });\n    };\n    return WithKueryAutocompletion;\n}(React.Component));\nexport { WithKueryAutocompletion };\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/containers/with_kuery_autocompletion.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/containers/with_kuery_autocompletion.tsx"],"names":[],"mappings":"AAAA;;;;GAIG;;AAEH,OAAO,KAAK,MAAM,OAAO,CAAC;AA2B1B;IAA6C,mDAG5C;IAHD;QAAA,qEAsDC;QAlDiB,WAAK,GAA0C;YAC7D,cAAc,EAAE,IAAI;YACpB,WAAW,EAAE,EAAE;SAChB,CAAC;QAYM,qBAAe,GAAG,UACxB,UAAkB,EAClB,cAAsB,EACtB,cAAuB;;;;;wBAEvB,IAAI,CAAC,QAAQ,CAAC;4BACZ,cAAc,EAAE;gCACd,UAAU,YAAA;gCACV,cAAc,gBAAA;6BACf;4BACD,WAAW,EAAE,EAAE;yBAChB,CAAC,CAAC;wBACC,WAAW,GAAU,EAAE,CAAC;;;;wBAEZ,qBAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,cAAc,CAC9D,UAAU,EACV,cAAc,EACd,IAAI,CAAC,KAAK,CAAC,WAAW,CACvB,EAAA;;wBAJD,WAAW,GAAG,SAIb,CAAC;;;;wBAEF,WAAW,GAAG,EAAE,CAAC;;;wBAGnB,IAAI,CAAC,QAAQ,CAAC,UAAA,KAAK;4BACjB,OAAA,KAAK,CAAC,cAAc;gCACpB,KAAK,CAAC,cAAc,CAAC,UAAU,KAAK,UAAU;gCAC9C,KAAK,CAAC,cAAc,CAAC,cAAc,KAAK,cAAc;gCACpD,CAAC,CAAC,KAAK,CAAC,yDAAyD;gCACjE,CAAC,sBACM,KAAK,IACR,cAAc,EAAE,IAAI,EACpB,WAAW,EAAE,cAAc,CAAC,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC,WAAW,GACjF;wBARL,CAQK,CACN,CAAC;;;;aACH,CAAC;;IACJ,CAAC;IA7CQ,wCAAM,GAAb;QACQ,IAAA,eAA4C,EAA1C,kCAAc,EAAE,4BAAW,CAAgB;QAEnD,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;YACzB,oBAAoB,EAAE,cAAc,KAAK,IAAI;YAC7C,eAAe,EAAE,IAAI,CAAC,eAAe;YACrC,WAAW,aAAA;SACZ,CAAC,CAAC;IACL,CAAC;IAqCH,8BAAC;AAAD,CAAC,AAtDD,CAA6C,KAAK,CAAC,SAAS,GAsD3D","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport React from 'react';\n\nimport { AutocompleteSuggestion } from 'ui/autocomplete_providers';\n\nimport { FrontendLibs } from '../lib/types';\nimport { RendererFunction } from '../utils/typed_react';\n\ninterface WithKueryAutocompletionLifecycleProps {\n  libs: FrontendLibs;\n  fieldPrefix?: string;\n  children: RendererFunction<{\n    isLoadingSuggestions: boolean;\n    loadSuggestions: (expression: string, cursorPosition: number, maxSuggestions?: number) => void;\n    suggestions: AutocompleteSuggestion[];\n  }>;\n}\n\ninterface WithKueryAutocompletionLifecycleState {\n  // lacking cancellation support in the autocompletion api,\n  // this is used to keep older, slower requests from clobbering newer ones\n  currentRequest: {\n    expression: string;\n    cursorPosition: number;\n  } | null;\n  suggestions: AutocompleteSuggestion[];\n}\n\nexport class WithKueryAutocompletion extends React.Component<\n  WithKueryAutocompletionLifecycleProps,\n  WithKueryAutocompletionLifecycleState\n> {\n  public readonly state: WithKueryAutocompletionLifecycleState = {\n    currentRequest: null,\n    suggestions: [],\n  };\n\n  public render() {\n    const { currentRequest, suggestions } = this.state;\n\n    return this.props.children({\n      isLoadingSuggestions: currentRequest !== null,\n      loadSuggestions: this.loadSuggestions,\n      suggestions,\n    });\n  }\n\n  private loadSuggestions = async (\n    expression: string,\n    cursorPosition: number,\n    maxSuggestions?: number\n  ) => {\n    this.setState({\n      currentRequest: {\n        expression,\n        cursorPosition,\n      },\n      suggestions: [],\n    });\n    let suggestions: any[] = [];\n    try {\n      suggestions = await this.props.libs.elasticsearch.getSuggestions(\n        expression,\n        cursorPosition,\n        this.props.fieldPrefix\n      );\n    } catch (e) {\n      suggestions = [];\n    }\n\n    this.setState(state =>\n      state.currentRequest &&\n      state.currentRequest.expression !== expression &&\n      state.currentRequest.cursorPosition !== cursorPosition\n        ? state // ignore this result, since a newer request is in flight\n        : {\n            ...state,\n            currentRequest: null,\n            suggestions: maxSuggestions ? suggestions.slice(0, maxSuggestions) : suggestions,\n          }\n    );\n  };\n}\n"]}]}