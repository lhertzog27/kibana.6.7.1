{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/router.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/router.tsx","mtime":1567631711884},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { get } from 'lodash';\nimport React, { Component } from 'react';\nimport { Redirect, Route, Switch } from 'react-router-dom';\nimport { Loading } from './components/loading';\nimport { ChildRoutes } from './components/navigation/child_routes';\nimport { WithURLState } from './containers/with_url_state';\nimport { routeMap } from './pages/index';\nvar AppRouter = /** @class */ (function (_super) {\n    tslib_1.__extends(AppRouter, _super);\n    function AppRouter(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            loading: true,\n        };\n        return _this;\n    }\n    AppRouter.prototype.componentWillMount = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var e_1;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(this.state.loading === true)) return [3 /*break*/, 6];\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 4, , 5]);\n                        return [4 /*yield*/, this.props.beatsContainer.reload()];\n                    case 2:\n                        _a.sent();\n                        return [4 /*yield*/, this.props.tagsContainer.reload()];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        e_1 = _a.sent();\n                        return [3 /*break*/, 5];\n                    case 5:\n                        this.setState({\n                            loading: false,\n                        });\n                        _a.label = 6;\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AppRouter.prototype.render = function () {\n        var _this = this;\n        if (this.state.loading === true) {\n            return React.createElement(Loading, null);\n        }\n        var countOfEverything = this.props.beatsContainer.state.list.length + this.props.tagsContainer.state.list.length;\n        return (React.createElement(React.Fragment, null,\n            React.createElement(Switch, null,\n                get(this.props.libs.framework.info, 'license.expired', true) && (React.createElement(Route, { render: function (props) {\n                        return !props.location.pathname.includes('/error') ? (React.createElement(Redirect, { to: \"/error/invalid_license\" })) : null;\n                    } })),\n                !get(this.props.libs.framework.info, 'security.enabled', true) && (React.createElement(Route, { render: function (props) {\n                        return !props.location.pathname.includes('/error') ? (React.createElement(Redirect, { to: \"/error/enforce_security\" })) : null;\n                    } })),\n                !this.props.libs.framework.currentUserHasOneOfRoles(['beats_admin'].concat(this.props.libs.framework.info.settings.defaultUserRoles)) && (React.createElement(Route, { render: function (props) {\n                        return !props.location.pathname.includes('/error') ? (React.createElement(Redirect, { to: \"/error/no_access\" })) : null;\n                    } })),\n                countOfEverything === 0 && (React.createElement(Route, { render: function (props) {\n                        return !props.location.pathname.includes('/walkthrough') ? (React.createElement(Redirect, { to: \"/walkthrough/initial\" })) : null;\n                    } })),\n                React.createElement(Route, { path: \"/\", exact: true, render: function () { return React.createElement(Redirect, { to: \"/overview/enrolled_beats\" }); } })),\n            React.createElement(WithURLState, null, function (URLProps) { return (React.createElement(ChildRoutes, tslib_1.__assign({ routes: routeMap }, URLProps, {\n                libs: _this.props.libs,\n                containers: {\n                    beats: _this.props.beatsContainer,\n                    tags: _this.props.tagsContainer,\n                },\n            }))); })));\n    };\n    return AppRouter;\n}(Component));\nexport { AppRouter };\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/router.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/beats_management/public/router.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport { get } from 'lodash';\nimport React, { Component } from 'react';\nimport { Redirect, Route, Switch } from 'react-router-dom';\nimport { Loading } from './components/loading';\nimport { ChildRoutes } from './components/navigation/child_routes';\nimport { BeatsContainer } from './containers/beats';\nimport { TagsContainer } from './containers/tags';\nimport { URLStateProps, WithURLState } from './containers/with_url_state';\nimport { FrontendLibs } from './lib/types';\nimport { routeMap } from './pages/index';\n\ninterface RouterProps {\n  libs: FrontendLibs;\n  tagsContainer: TagsContainer;\n  beatsContainer: BeatsContainer;\n}\ninterface RouterState {\n  loading: boolean;\n}\n\nexport class AppRouter extends Component<RouterProps, RouterState> {\n  constructor(props: RouterProps) {\n    super(props);\n    this.state = {\n      loading: true,\n    };\n  }\n\n  public async componentWillMount() {\n    if (this.state.loading === true) {\n      try {\n        await this.props.beatsContainer.reload();\n        await this.props.tagsContainer.reload();\n      } catch (e) {\n        // TODO in a furture version we will better manage this \"error\" in a returned arg\n      }\n\n      this.setState({\n        loading: false,\n      });\n    }\n  }\n\n  public render() {\n    if (this.state.loading === true) {\n      return <Loading />;\n    }\n\n    const countOfEverything =\n      this.props.beatsContainer.state.list.length + this.props.tagsContainer.state.list.length;\n\n    return (\n      <React.Fragment>\n        {/* Redirects mapping */}\n        <Switch>\n          {/* License check (UI displays when license exists but is expired) */}\n          {get(this.props.libs.framework.info, 'license.expired', true) && (\n            <Route\n              render={props =>\n                !props.location.pathname.includes('/error') ? (\n                  <Redirect to=\"/error/invalid_license\" />\n                ) : null\n              }\n            />\n          )}\n\n          {/* Ensure security is eanabled for elastic and kibana */}\n          {!get(this.props.libs.framework.info, 'security.enabled', true) && (\n            <Route\n              render={props =>\n                !props.location.pathname.includes('/error') ? (\n                  <Redirect to=\"/error/enforce_security\" />\n                ) : null\n              }\n            />\n          )}\n\n          {/* Make sure the user has correct permissions */}\n          {!this.props.libs.framework.currentUserHasOneOfRoles(\n            ['beats_admin'].concat(this.props.libs.framework.info.settings.defaultUserRoles)\n          ) && (\n            <Route\n              render={props =>\n                !props.location.pathname.includes('/error') ? (\n                  <Redirect to=\"/error/no_access\" />\n                ) : null\n              }\n            />\n          )}\n\n          {/* If there are no beats or tags yet, redirect to the walkthrough */}\n          {countOfEverything === 0 && (\n            <Route\n              render={props =>\n                !props.location.pathname.includes('/walkthrough') ? (\n                  <Redirect to=\"/walkthrough/initial\" />\n                ) : null\n              }\n            />\n          )}\n\n          {/* This app does not make use of a homepage. The mainpage is overview/enrolled_beats */}\n          <Route path=\"/\" exact={true} render={() => <Redirect to=\"/overview/enrolled_beats\" />} />\n        </Switch>\n\n        {/* Render routes from the FS */}\n        <WithURLState>\n          {(URLProps: URLStateProps) => (\n            <ChildRoutes\n              routes={routeMap}\n              {...URLProps}\n              {...{\n                libs: this.props.libs,\n                containers: {\n                  beats: this.props.beatsContainer,\n                  tags: this.props.tagsContainer,\n                },\n              }}\n            />\n          )}\n        </WithURLState>\n      </React.Fragment>\n    );\n  }\n}\n"]}]}