{"remainingRequest":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js??ref--10-1!/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js??ref--10-2!/home/anthony/git_workspaces/kibana/x-pack/plugins/security/public/views/management/edit_role/components/privileges/kibana/impacted_spaces_flyout.tsx","dependencies":[{"path":"/home/anthony/git_workspaces/kibana/x-pack/plugins/security/public/views/management/edit_role/components/privileges/kibana/impacted_spaces_flyout.tsx","mtime":1567631712301},{"path":"/home/anthony/git_workspaces/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1567666236302},{"path":"/home/anthony/git_workspaces/kibana/node_modules/thread-loader/dist/cjs.js","mtime":1567666239443},{"path":"/home/anthony/git_workspaces/kibana/node_modules/ts-loader/index.js","mtime":1567666229769}],"contextDependencies":[],"result":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { EuiFlyout, EuiFlyoutBody, EuiFlyoutFooter, EuiFlyoutHeader, EuiLink, EuiTitle, } from '@elastic/eui';\nimport { FormattedMessage, injectI18n } from '@kbn/i18n/react';\nimport React, { Component, Fragment } from 'react';\nimport { PrivilegeSpaceTable } from './privilege_space_table';\nimport { ManageSpacesButton } from '../../../../../../../../spaces/public/components';\nimport { NO_PRIVILEGE_VALUE } from '../../../lib/constants';\nvar ImpactedSpacesFlyoutUI = /** @class */ (function (_super) {\n    tslib_1.__extends(ImpactedSpacesFlyoutUI, _super);\n    function ImpactedSpacesFlyoutUI(props) {\n        var _this = _super.call(this, props) || this;\n        _this.toggleShowImpactedSpaces = function () {\n            _this.setState({\n                showImpactedSpaces: !_this.state.showImpactedSpaces,\n            });\n        };\n        _this.getFlyout = function () {\n            if (!_this.state.showImpactedSpaces) {\n                return null;\n            }\n            var _a = _this.props, role = _a.role, spaces = _a.spaces;\n            var assignedPrivileges = role.kibana;\n            var basePrivilege = assignedPrivileges.global.length\n                ? assignedPrivileges.global[0]\n                : NO_PRIVILEGE_VALUE;\n            var allSpacePrivileges = spaces.reduce(function (acc, space) {\n                var _a;\n                var spacePrivilege = assignedPrivileges.space[space.id]\n                    ? assignedPrivileges.space[space.id][0]\n                    : basePrivilege;\n                var actualPrivilege = _this.getHighestPrivilege(spacePrivilege, basePrivilege);\n                return tslib_1.__assign({}, acc, (_a = {}, _a[space.id] = [actualPrivilege], _a));\n            }, tslib_1.__assign({}, role.kibana.space));\n            return (React.createElement(EuiFlyout, { onClose: _this.toggleShowImpactedSpaces, \"aria-labelledby\": \"showImpactedSpacesTitle\", size: \"s\" },\n                React.createElement(EuiFlyoutHeader, { hasBorder: true },\n                    React.createElement(EuiTitle, { size: \"m\" },\n                        React.createElement(\"h1\", { id: \"showImpactedSpacesTitle\" },\n                            React.createElement(FormattedMessage, { id: \"xpack.security.management.editRoles.impactedSpacesFlyout.spacePrivilegesSummaryTitle\", defaultMessage: \"Summary of space privileges\" })))),\n                React.createElement(EuiFlyoutBody, null,\n                    React.createElement(PrivilegeSpaceTable, { readonly: true, role: role, spaces: spaces, spacePrivileges: allSpacePrivileges })),\n                React.createElement(EuiFlyoutFooter, { className: \"showImpactedSpaces--flyout--footer\" },\n                    React.createElement(ManageSpacesButton, { userProfile: _this.props.userProfile }))));\n        };\n        _this.state = {\n            showImpactedSpaces: false,\n        };\n        return _this;\n    }\n    ImpactedSpacesFlyoutUI.prototype.render = function () {\n        var flyout = this.getFlyout();\n        return (React.createElement(Fragment, null,\n            React.createElement(\"div\", { className: \"showImpactedSpaces\" },\n                React.createElement(EuiLink, { onClick: this.toggleShowImpactedSpaces },\n                    React.createElement(FormattedMessage, { id: \"xpack.security.management.editRoles.impactedSpacesFlyout.viewSpacesPrivilegesSummaryLinkText\", defaultMessage: \"View summary of spaces privileges\" }))),\n            flyout));\n    };\n    ImpactedSpacesFlyoutUI.prototype.getHighestPrivilege = function () {\n        var privileges = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            privileges[_i] = arguments[_i];\n        }\n        var intl = this.props.intl;\n        if (privileges.indexOf('all') >= 0) {\n            return intl.formatMessage({\n                id: 'xpack.security.management.editRoles.impactedSpacesFlyout.allLabel',\n                defaultMessage: 'all',\n            });\n        }\n        if (privileges.indexOf('read') >= 0) {\n            return intl.formatMessage({\n                id: 'xpack.security.management.editRoles.impactedSpacesFlyout.readLabel',\n                defaultMessage: 'read',\n            });\n        }\n        return intl.formatMessage({\n            id: 'xpack.security.management.editRoles.impactedSpacesFlyout.noneLabel',\n            defaultMessage: 'none',\n        });\n    };\n    return ImpactedSpacesFlyoutUI;\n}(Component));\nexport var ImpactedSpacesFlyout = injectI18n(ImpactedSpacesFlyoutUI);\n",{"version":3,"file":"/home/anthony/git_workspaces/kibana/x-pack/plugins/security/public/views/management/edit_role/components/privileges/kibana/impacted_spaces_flyout.tsx","sourceRoot":"","sources":["/home/anthony/git_workspaces/kibana/x-pack/plugins/security/public/views/management/edit_role/components/privileges/kibana/impacted_spaces_flyout.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License;\n * you may not use this file except in compliance with the Elastic License.\n */\n\nimport {\n  EuiFlyout,\n  EuiFlyoutBody,\n  EuiFlyoutFooter,\n  EuiFlyoutHeader,\n  EuiLink,\n  EuiTitle,\n} from '@elastic/eui';\nimport { FormattedMessage, InjectedIntl, injectI18n } from '@kbn/i18n/react';\nimport React, { Component, Fragment } from 'react';\nimport { PrivilegeSpaceTable } from './privilege_space_table';\n\nimport { Space } from '../../../../../../../../spaces/common/model/space';\nimport { ManageSpacesButton } from '../../../../../../../../spaces/public/components';\nimport { UserProfile } from '../../../../../../../../xpack_main/public/services/user_profile';\nimport { KibanaPrivilege } from '../../../../../../../common/model/kibana_privilege';\nimport { Role } from '../../../../../../../common/model/role';\nimport { NO_PRIVILEGE_VALUE } from '../../../lib/constants';\n\ninterface Props {\n  role: Role;\n  spaces: Space[];\n  userProfile: UserProfile;\n  intl: InjectedIntl;\n}\n\ninterface State {\n  showImpactedSpaces: boolean;\n}\n\nclass ImpactedSpacesFlyoutUI extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      showImpactedSpaces: false,\n    };\n  }\n\n  public render() {\n    const flyout = this.getFlyout();\n    return (\n      <Fragment>\n        <div className=\"showImpactedSpaces\">\n          <EuiLink onClick={this.toggleShowImpactedSpaces}>\n            <FormattedMessage\n              id=\"xpack.security.management.editRoles.impactedSpacesFlyout.viewSpacesPrivilegesSummaryLinkText\"\n              defaultMessage=\"View summary of spaces privileges\"\n            />\n          </EuiLink>\n        </div>\n        {flyout}\n      </Fragment>\n    );\n  }\n\n  public toggleShowImpactedSpaces = () => {\n    this.setState({\n      showImpactedSpaces: !this.state.showImpactedSpaces,\n    });\n  };\n\n  public getHighestPrivilege(...privileges: KibanaPrivilege[]): KibanaPrivilege {\n    const { intl } = this.props;\n    if (privileges.indexOf('all') >= 0) {\n      return intl.formatMessage({\n        id: 'xpack.security.management.editRoles.impactedSpacesFlyout.allLabel',\n        defaultMessage: 'all',\n      }) as KibanaPrivilege;\n    }\n    if (privileges.indexOf('read') >= 0) {\n      return intl.formatMessage({\n        id: 'xpack.security.management.editRoles.impactedSpacesFlyout.readLabel',\n        defaultMessage: 'read',\n      }) as KibanaPrivilege;\n    }\n    return intl.formatMessage({\n      id: 'xpack.security.management.editRoles.impactedSpacesFlyout.noneLabel',\n      defaultMessage: 'none',\n    }) as KibanaPrivilege;\n  }\n\n  public getFlyout = () => {\n    if (!this.state.showImpactedSpaces) {\n      return null;\n    }\n\n    const { role, spaces } = this.props;\n\n    const assignedPrivileges = role.kibana;\n    const basePrivilege = assignedPrivileges.global.length\n      ? assignedPrivileges.global[0]\n      : NO_PRIVILEGE_VALUE;\n\n    const allSpacePrivileges = spaces.reduce(\n      (acc, space) => {\n        const spacePrivilege = assignedPrivileges.space[space.id]\n          ? assignedPrivileges.space[space.id][0]\n          : basePrivilege;\n        const actualPrivilege = this.getHighestPrivilege(spacePrivilege, basePrivilege);\n\n        return {\n          ...acc,\n          // Use the privilege assigned to the space, if provided. Otherwise, the baes privilege is used.\n          [space.id]: [actualPrivilege],\n        };\n      },\n      { ...role.kibana.space }\n    );\n\n    return (\n      <EuiFlyout\n        onClose={this.toggleShowImpactedSpaces}\n        aria-labelledby=\"showImpactedSpacesTitle\"\n        size=\"s\"\n      >\n        <EuiFlyoutHeader hasBorder>\n          <EuiTitle size=\"m\">\n            <h1 id=\"showImpactedSpacesTitle\">\n              <FormattedMessage\n                id=\"xpack.security.management.editRoles.impactedSpacesFlyout.spacePrivilegesSummaryTitle\"\n                defaultMessage=\"Summary of space privileges\"\n              />\n            </h1>\n          </EuiTitle>\n        </EuiFlyoutHeader>\n        <EuiFlyoutBody>\n          <PrivilegeSpaceTable\n            readonly={true}\n            role={role}\n            spaces={spaces}\n            spacePrivileges={allSpacePrivileges}\n          />\n        </EuiFlyoutBody>\n        <EuiFlyoutFooter className=\"showImpactedSpaces--flyout--footer\">\n          {/* TODO: Hide footer if button is not available */}\n          <ManageSpacesButton userProfile={this.props.userProfile} />\n        </EuiFlyoutFooter>\n      </EuiFlyout>\n    );\n  };\n}\n\nexport const ImpactedSpacesFlyout = injectI18n(ImpactedSpacesFlyoutUI);\n"]}]}