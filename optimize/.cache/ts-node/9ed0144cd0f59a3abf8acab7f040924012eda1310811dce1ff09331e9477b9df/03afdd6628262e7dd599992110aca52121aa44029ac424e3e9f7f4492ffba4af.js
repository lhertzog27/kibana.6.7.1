"use strict";
/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License;
 * you may not use this file except in compliance with the Elastic License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const constants_1 = require("./constants");
function createCollectorFetch(server) {
    return async function fetchUsageStats() {
        const { id } = server.config().get(`xpack.cloud`);
        return {
            isCloudEnabled: !!id,
        };
    };
}
exports.createCollectorFetch = createCollectorFetch;
/*
 * @param {Object} server
 * @return {Object} kibana usage stats type collection object
 */
function getCloudUsageCollector(server) {
    const { collectorSet } = server.usage;
    return collectorSet.makeUsageCollector({
        type: constants_1.KIBANA_CLOUD_STATS_TYPE,
        fetch: createCollectorFetch(server),
    });
}
exports.getCloudUsageCollector = getCloudUsageCollector;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvYW50aG9ueS9naXRfd29ya3NwYWNlcy9raWJhbmEveC1wYWNrL3BsdWdpbnMvY2xvdWQvZ2V0X2Nsb3VkX3VzYWdlX2NvbGxlY3Rvci50cyIsInNvdXJjZXMiOlsiL2hvbWUvYW50aG9ueS9naXRfd29ya3NwYWNlcy9raWJhbmEveC1wYWNrL3BsdWdpbnMvY2xvdWQvZ2V0X2Nsb3VkX3VzYWdlX2NvbGxlY3Rvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7R0FJRzs7QUFHSCwyQ0FBc0Q7QUFjdEQsU0FBZ0Isb0JBQW9CLENBQUMsTUFBVztJQUM5QyxPQUFPLEtBQUssVUFBVSxlQUFlO1FBQ25DLE1BQU0sRUFBRSxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBRWxELE9BQU87WUFDTCxjQUFjLEVBQUUsQ0FBQyxDQUFDLEVBQUU7U0FDckIsQ0FBQztJQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFSRCxvREFRQztBQUVEOzs7R0FHRztBQUNILFNBQWdCLHNCQUFzQixDQUFDLE1BQXdCO0lBQzdELE1BQU0sRUFBRSxZQUFZLEVBQUUsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDO0lBQ3RDLE9BQU8sWUFBWSxDQUFDLGtCQUFrQixDQUFDO1FBQ3JDLElBQUksRUFBRSxtQ0FBdUI7UUFDN0IsS0FBSyxFQUFFLG9CQUFvQixDQUFDLE1BQU0sQ0FBQztLQUNwQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBTkQsd0RBTUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IEVsYXN0aWNzZWFyY2ggQi5WLiBhbmQvb3IgbGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuIExpY2Vuc2VkIHVuZGVyIHRoZSBFbGFzdGljIExpY2Vuc2U7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIEVsYXN0aWMgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBTZXJ2ZXIgfSBmcm9tICdoYXBpJztcbmltcG9ydCB7IEtJQkFOQV9DTE9VRF9TVEFUU19UWVBFIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFVzYWdlU3RhdHMge1xuICBpc0Nsb3VkRW5hYmxlZDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBLaWJhbmFIYXBpU2VydmVyIGV4dGVuZHMgU2VydmVyIHtcbiAgdXNhZ2U6IHtcbiAgICBjb2xsZWN0b3JTZXQ6IHtcbiAgICAgIG1ha2VVc2FnZUNvbGxlY3RvcjogYW55O1xuICAgIH07XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDb2xsZWN0b3JGZXRjaChzZXJ2ZXI6IGFueSkge1xuICByZXR1cm4gYXN5bmMgZnVuY3Rpb24gZmV0Y2hVc2FnZVN0YXRzKCk6IFByb21pc2U8VXNhZ2VTdGF0cz4ge1xuICAgIGNvbnN0IHsgaWQgfSA9IHNlcnZlci5jb25maWcoKS5nZXQoYHhwYWNrLmNsb3VkYCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaXNDbG91ZEVuYWJsZWQ6ICEhaWQsXG4gICAgfTtcbiAgfTtcbn1cblxuLypcbiAqIEBwYXJhbSB7T2JqZWN0fSBzZXJ2ZXJcbiAqIEByZXR1cm4ge09iamVjdH0ga2liYW5hIHVzYWdlIHN0YXRzIHR5cGUgY29sbGVjdGlvbiBvYmplY3RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENsb3VkVXNhZ2VDb2xsZWN0b3Ioc2VydmVyOiBLaWJhbmFIYXBpU2VydmVyKSB7XG4gIGNvbnN0IHsgY29sbGVjdG9yU2V0IH0gPSBzZXJ2ZXIudXNhZ2U7XG4gIHJldHVybiBjb2xsZWN0b3JTZXQubWFrZVVzYWdlQ29sbGVjdG9yKHtcbiAgICB0eXBlOiBLSUJBTkFfQ0xPVURfU1RBVFNfVFlQRSxcbiAgICBmZXRjaDogY3JlYXRlQ29sbGVjdG9yRmV0Y2goc2VydmVyKSxcbiAgfSk7XG59XG4iXX0=