"use strict";
/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License;
 * you may not use this file except in compliance with the Elastic License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const auth_1 = require("../adapters/auth");
const kibana_database_adapter_1 = require("../adapters/database/kibana_database_adapter");
const framework_1 = require("../adapters/framework");
const monitors_1 = require("../adapters/monitors");
const pings_1 = require("../adapters/pings");
const domains_1 = require("../domains");
function compose(hapiServer) {
    const framework = new framework_1.UMKibanaBackendFrameworkAdapter(hapiServer);
    const database = new kibana_database_adapter_1.UMKibanaDatabaseAdapter(hapiServer.plugins.elasticsearch);
    const pingsDomain = new domains_1.UMPingsDomain(new pings_1.ElasticsearchPingsAdapter(database), {});
    const authDomain = new domains_1.UMAuthDomain(new auth_1.UMXPackAuthAdapter(hapiServer.plugins.xpack_main), {});
    const monitorsDomain = new domains_1.UMMonitorsDomain(new monitors_1.ElasticsearchMonitorsAdapter(database), {});
    const domainLibs = {
        pings: pingsDomain,
        auth: authDomain,
        monitors: monitorsDomain,
    };
    const libs = {
        framework,
        database,
        ...domainLibs,
    };
    return libs;
}
exports.compose = compose;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvYW50aG9ueS9naXRfd29ya3NwYWNlcy9raWJhbmEveC1wYWNrL3BsdWdpbnMvdXB0aW1lL3NlcnZlci9saWIvY29tcG9zZS9raWJhbmEudHMiLCJzb3VyY2VzIjpbIi9ob21lL2FudGhvbnkvZ2l0X3dvcmtzcGFjZXMva2liYW5hL3gtcGFjay9wbHVnaW5zL3VwdGltZS9zZXJ2ZXIvbGliL2NvbXBvc2Uva2liYW5hLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7OztHQUlHOztBQUVILDJDQUFzRDtBQUN0RCwwRkFBdUY7QUFDdkYscURBQXdFO0FBQ3hFLG1EQUFvRTtBQUNwRSw2Q0FBOEQ7QUFDOUQsd0NBQTJFO0FBRzNFLFNBQWdCLE9BQU8sQ0FBQyxVQUFlO0lBQ3JDLE1BQU0sU0FBUyxHQUFHLElBQUksMkNBQStCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDbEUsTUFBTSxRQUFRLEdBQUcsSUFBSSxpREFBdUIsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBRS9FLE1BQU0sV0FBVyxHQUFHLElBQUksdUJBQWEsQ0FBQyxJQUFJLGlDQUF5QixDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ25GLE1BQU0sVUFBVSxHQUFHLElBQUksc0JBQVksQ0FBQyxJQUFJLHlCQUFrQixDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDL0YsTUFBTSxjQUFjLEdBQUcsSUFBSSwwQkFBZ0IsQ0FBQyxJQUFJLHVDQUE0QixDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBRTVGLE1BQU0sVUFBVSxHQUFpQjtRQUMvQixLQUFLLEVBQUUsV0FBVztRQUNsQixJQUFJLEVBQUUsVUFBVTtRQUNoQixRQUFRLEVBQUUsY0FBYztLQUN6QixDQUFDO0lBRUYsTUFBTSxJQUFJLEdBQWlCO1FBQ3pCLFNBQVM7UUFDVCxRQUFRO1FBQ1IsR0FBRyxVQUFVO0tBQ2QsQ0FBQztJQUVGLE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQXJCRCwwQkFxQkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IEVsYXN0aWNzZWFyY2ggQi5WLiBhbmQvb3IgbGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuIExpY2Vuc2VkIHVuZGVyIHRoZSBFbGFzdGljIExpY2Vuc2U7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIEVsYXN0aWMgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBVTVhQYWNrQXV0aEFkYXB0ZXIgfSBmcm9tICcuLi9hZGFwdGVycy9hdXRoJztcbmltcG9ydCB7IFVNS2liYW5hRGF0YWJhc2VBZGFwdGVyIH0gZnJvbSAnLi4vYWRhcHRlcnMvZGF0YWJhc2Uva2liYW5hX2RhdGFiYXNlX2FkYXB0ZXInO1xuaW1wb3J0IHsgVU1LaWJhbmFCYWNrZW5kRnJhbWV3b3JrQWRhcHRlciB9IGZyb20gJy4uL2FkYXB0ZXJzL2ZyYW1ld29yayc7XG5pbXBvcnQgeyBFbGFzdGljc2VhcmNoTW9uaXRvcnNBZGFwdGVyIH0gZnJvbSAnLi4vYWRhcHRlcnMvbW9uaXRvcnMnO1xuaW1wb3J0IHsgRWxhc3RpY3NlYXJjaFBpbmdzQWRhcHRlciB9IGZyb20gJy4uL2FkYXB0ZXJzL3BpbmdzJztcbmltcG9ydCB7IFVNQXV0aERvbWFpbiwgVU1Nb25pdG9yc0RvbWFpbiwgVU1QaW5nc0RvbWFpbiB9IGZyb20gJy4uL2RvbWFpbnMnO1xuaW1wb3J0IHsgVU1Eb21haW5MaWJzLCBVTVNlcnZlckxpYnMgfSBmcm9tICcuLi9saWInO1xuXG5leHBvcnQgZnVuY3Rpb24gY29tcG9zZShoYXBpU2VydmVyOiBhbnkpOiBVTVNlcnZlckxpYnMge1xuICBjb25zdCBmcmFtZXdvcmsgPSBuZXcgVU1LaWJhbmFCYWNrZW5kRnJhbWV3b3JrQWRhcHRlcihoYXBpU2VydmVyKTtcbiAgY29uc3QgZGF0YWJhc2UgPSBuZXcgVU1LaWJhbmFEYXRhYmFzZUFkYXB0ZXIoaGFwaVNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2gpO1xuXG4gIGNvbnN0IHBpbmdzRG9tYWluID0gbmV3IFVNUGluZ3NEb21haW4obmV3IEVsYXN0aWNzZWFyY2hQaW5nc0FkYXB0ZXIoZGF0YWJhc2UpLCB7fSk7XG4gIGNvbnN0IGF1dGhEb21haW4gPSBuZXcgVU1BdXRoRG9tYWluKG5ldyBVTVhQYWNrQXV0aEFkYXB0ZXIoaGFwaVNlcnZlci5wbHVnaW5zLnhwYWNrX21haW4pLCB7fSk7XG4gIGNvbnN0IG1vbml0b3JzRG9tYWluID0gbmV3IFVNTW9uaXRvcnNEb21haW4obmV3IEVsYXN0aWNzZWFyY2hNb25pdG9yc0FkYXB0ZXIoZGF0YWJhc2UpLCB7fSk7XG5cbiAgY29uc3QgZG9tYWluTGliczogVU1Eb21haW5MaWJzID0ge1xuICAgIHBpbmdzOiBwaW5nc0RvbWFpbixcbiAgICBhdXRoOiBhdXRoRG9tYWluLFxuICAgIG1vbml0b3JzOiBtb25pdG9yc0RvbWFpbixcbiAgfTtcblxuICBjb25zdCBsaWJzOiBVTVNlcnZlckxpYnMgPSB7XG4gICAgZnJhbWV3b3JrLFxuICAgIGRhdGFiYXNlLFxuICAgIC4uLmRvbWFpbkxpYnMsXG4gIH07XG5cbiAgcmV0dXJuIGxpYnM7XG59XG4iXX0=