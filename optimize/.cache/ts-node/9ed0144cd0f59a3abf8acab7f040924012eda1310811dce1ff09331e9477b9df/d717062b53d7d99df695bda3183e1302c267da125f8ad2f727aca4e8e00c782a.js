"use strict";
/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License;
 * you may not use this file except in compliance with the Elastic License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
let factories = [];
function removeAllFactories() {
    factories = [];
}
exports.removeAllFactories = removeAllFactories;
function registerUserProfileCapabilityFactory(factory) {
    factories.push(factory);
}
exports.registerUserProfileCapabilityFactory = registerUserProfileCapabilityFactory;
async function buildUserProfile(request) {
    const factoryPromises = factories.map(async (factory) => ({
        ...(await factory(request)),
    }));
    const factoryResults = await Promise.all(factoryPromises);
    return factoryResults.reduce((acc, capabilities) => {
        return {
            ...acc,
            ...capabilities,
        };
    }, {});
}
exports.buildUserProfile = buildUserProfile;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvYW50aG9ueS9naXRfd29ya3NwYWNlcy9raWJhbmEveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL3VzZXJfcHJvZmlsZV9yZWdpc3RyeS50cyIsInNvdXJjZXMiOlsiL2hvbWUvYW50aG9ueS9naXRfd29ya3NwYWNlcy9raWJhbmEveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL3VzZXJfcHJvZmlsZV9yZWdpc3RyeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7R0FJRzs7QUFJSCxJQUFJLFNBQVMsR0FBd0IsRUFBRSxDQUFDO0FBRXhDLFNBQWdCLGtCQUFrQjtJQUNoQyxTQUFTLEdBQUcsRUFBRSxDQUFDO0FBQ2pCLENBQUM7QUFGRCxnREFFQztBQUVELFNBQWdCLG9DQUFvQyxDQUFDLE9BQTBCO0lBQzdFLFNBQVMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDMUIsQ0FBQztBQUZELG9GQUVDO0FBRU0sS0FBSyxVQUFVLGdCQUFnQixDQUFDLE9BQVk7SUFDakQsTUFBTSxlQUFlLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUMsT0FBTyxFQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3RELEdBQUcsQ0FBQyxNQUFNLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztLQUM1QixDQUFDLENBQUMsQ0FBQztJQUVKLE1BQU0sY0FBYyxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUUxRCxPQUFPLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsWUFBWSxFQUFFLEVBQUU7UUFDakQsT0FBTztZQUNMLEdBQUcsR0FBRztZQUNOLEdBQUcsWUFBWTtTQUNoQixDQUFDO0lBQ0osQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ1QsQ0FBQztBQWJELDRDQWFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCBFbGFzdGljc2VhcmNoIEIuVi4gYW5kL29yIGxpY2Vuc2VkIHRvIEVsYXN0aWNzZWFyY2ggQi5WLiB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiBMaWNlbnNlZCB1bmRlciB0aGUgRWxhc3RpYyBMaWNlbnNlO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBFbGFzdGljIExpY2Vuc2UuXG4gKi9cblxuZXhwb3J0IHR5cGUgQ2FwYWJpbGl0eUZhY3RvcnkgPSAocmVxdWVzdDogYW55KSA9PiBQcm9taXNlPHsgW2NhcGFiaWxpdHk6IHN0cmluZ106IGJvb2xlYW4gfT47XG5cbmxldCBmYWN0b3JpZXM6IENhcGFiaWxpdHlGYWN0b3J5W10gPSBbXTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUFsbEZhY3RvcmllcygpIHtcbiAgZmFjdG9yaWVzID0gW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlclVzZXJQcm9maWxlQ2FwYWJpbGl0eUZhY3RvcnkoZmFjdG9yeTogQ2FwYWJpbGl0eUZhY3RvcnkpIHtcbiAgZmFjdG9yaWVzLnB1c2goZmFjdG9yeSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZFVzZXJQcm9maWxlKHJlcXVlc3Q6IGFueSkge1xuICBjb25zdCBmYWN0b3J5UHJvbWlzZXMgPSBmYWN0b3JpZXMubWFwKGFzeW5jIGZhY3RvcnkgPT4gKHtcbiAgICAuLi4oYXdhaXQgZmFjdG9yeShyZXF1ZXN0KSksXG4gIH0pKTtcblxuICBjb25zdCBmYWN0b3J5UmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKGZhY3RvcnlQcm9taXNlcyk7XG5cbiAgcmV0dXJuIGZhY3RvcnlSZXN1bHRzLnJlZHVjZSgoYWNjLCBjYXBhYmlsaXRpZXMpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uYWNjLFxuICAgICAgLi4uY2FwYWJpbGl0aWVzLFxuICAgIH07XG4gIH0sIHt9KTtcbn1cbiJdfQ==